(()=>{var e,t={9508:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initPage:()=>xn});var r={};n.r(r),n.d(r,{getAccount:()=>h,getCurrency:()=>G,getDeactivationDate:()=>Q,getEmail:()=>A,getExtraQuotaUnits:()=>M,getFirstname:()=>O,getFullname:()=>k,getInvoices:()=>x,getLastname:()=>P,getLicense:()=>L,getMode:()=>B,getNextChargeDate:()=>V,getNextChargeTotal:()=>q,getPeriod:()=>j,getPhoto:()=>T,getPlan:()=>F,getProductDisplay:()=>U,getSite:()=>y,getSites:()=>E,getSitesAllowed:()=>Y,getStartDate:()=>D,getState:()=>R,getSubscriptionAddons:()=>S,getSubscriptionId:()=>N,getSubscriptionProduct:()=>I,getSubscriptionQuota:()=>w,getUrlToManagePayments:()=>K,isAgency:()=>W,isAgencyFullViewEnabled:()=>H,isLocked:()=>$,isSubscriptionDeprecated:()=>C});var a={};n.r(a),n.d(a,{enableAgencyFullView:()=>X,lock:()=>z,receiveAccount:()=>Z,receiveInvoices:()=>te,receiveSites:()=>ee,removeSiteAfterUnlink:()=>ne,unlock:()=>J});var i={};n.r(i),n.d(i,{cancelSubscription:()=>ge,limitSiteQuota:()=>he,linkSite:()=>fe,uncancelSubscription:()=>ve,unlinkSite:()=>be,upgradeSubscription:()=>_e});var o={};n.r(o),n.d(o,{getAccount:()=>xe,getInvoices:()=>Se,getSites:()=>Ne,getSubscriptionQuota:()=>we});const c=window.wp.element;window.wp.domReady;const l=window.wp.notices,s=window.wp.components,u=window.wp.i18n,m=window.nab.components;var d=[{label:(0,u._x)("How do I change my payment details?","text","nelio-ab-testing"),link:(0,u._x)("https://neliosoftware.com/testing/help/how-do-i-change-my-payment-details/","text","nelio-ab-testing")},{label:(0,u._x)("What if my monthly quota of page views gets exhausted?","text","nelio-ab-testing"),link:(0,u._x)("https://neliosoftware.com/testing/help/what-if-my-monthly-quota-gets-exhausted/","text","nelio-ab-testing")}],p=function(e){var t=e.isSubscribed,n=e.siteId;return c.createElement("h1",{className:"wp-heading-inline nelio-ab-testing-page-title"},c.createElement("span",null,t?(0,u._x)("Account Details","text","nelio-ab-testing"):(0,u._x)("Upgrade to Nelio A/B Testing Premium","user","nelio-ab-testing")),c.createElement("span",{className:"nelio-ab-testing-page-title__support-key"},c.createElement("strong",null,(0,u._x)("Support Key:","text","nelio-ab-testing")),c.createElement("code",null,n),c.createElement(m.ClipboardButton,{text:n})))};const f=window.wp.data;function b(e,t){return(0,f.useSelect)(e,t)}const g=window.lodash;var v={account:{currency:"USD",deactivationDate:"",email:"",firstname:"",fullname:"",isAgency:!1,lastname:"",license:"",mode:"free",nextChargeDate:"",nextChargeTotal:"",period:"month",photo:"",plan:"free",productDisplay:"",productId:"",quota:500,quotaExtra:0,quotaPerMonth:0,sitesAllowed:1,startDate:"",state:"active",subscription:"",addons:[],addonDetails:{},urlToManagePayments:""},invoices:[],sites:[],isPageLocked:!1,isAgencyFullViewEnabled:!1},_=function(){return _=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_.apply(this,arguments)};function h(e){return e.account}function E(e,t){return t?e.sites:[]}function y(e,t){return(0,g.find)(e.sites,{id:t})}function x(e,t){return t?e.invoices:[]}function w(e){var t=e.account,n=t.quota,r=t.quotaExtra,a=t.quotaPerMonth,i=n+r;return{mode:"subscription",availableQuota:i,percentage:Math.floor(100*(i+.1)/a)}}function N(e){return e.account.subscription}function S(e){return e.account.addons||[]}function C(e){return!!e.account.subscription.startsWith("OL")}function k(e){return e.account.fullname}function O(e){return e.account.firstname}function P(e){return e.account.lastname}function A(e){return e.account.email}function D(e){return e.account.startDate}function I(e){return e.account.productId}function F(e){return e.account.plan}function L(e){return e.account.license}function T(e){return e.account.photo}function U(e){return e.account.productDisplay}function B(e){return e.account.mode}function j(e){return e.account.period}function M(e){var t,n;return null!==(n=null!==(t=e.account.addonDetails["nab-pageviews-monthly"])&&void 0!==t?t:e.account.addonDetails["nab-pageviews-yearly"])&&void 0!==n?n:0}function R(e){return e.account.state}function Q(e){return e.account.deactivationDate}function V(e){return e.account.nextChargeDate}function q(e){return e.account.nextChargeTotal}function Y(e){return e.account.sitesAllowed}function G(e){return e.account.currency}function K(e){return e.account.urlToManagePayments}function W(e){return!!e.account.isAgency}function $(e){return!!e.isPageLocked}function H(e){return W(e)&&!!e.isAgencyFullViewEnabled}function z(){return{type:"LOCK_PAGE"}}function J(){return{type:"UNLOCK_PAGE"}}function X(){return{type:"ENABLE_AGENCY_FULL_VIEW"}}function Z(e){return{type:"RECEIVE_ACCOUNT",account:e}}function ee(e){return{type:"RECEIVE_SITES",sites:(0,g.castArray)(e)}}function te(e){return{type:"RECEIVE_INVOICES",invoices:(0,g.castArray)(e)}}function ne(e){return{type:"UNLINK_SITE",id:e}}const re=window.wp.apiFetch;var ae=n.n(re);const ie=window.wp.date,oe=window.wp.url;var ce=function(){return ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ce.apply(this,arguments)};const le=function(e){var t=e.url,n=e.path,r=(0,ie.format)("YmjHi").substring(0,11)+"0";return ae()(ce(ce(ce({},e),t&&{url:se(e)?(0,oe.addQueryArgs)(t,{nabts:r}):t}),n&&{path:(0,oe.addQueryArgs)(n,{nabts:r})}))};var se=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const ue=window.nab.utils;var me=function(){return me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},me.apply(this,arguments)},de=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function fe(e){return de(this,void 0,Promise,(function(){var t;return pe(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,6]),[4,(0,f.dispatch)(Oe).lock()];case 1:return n.sent(),[4,le({path:"/nab/v1/site/subscription",method:"POST",data:{license:e}})];case 2:return n.sent(),window.location.reload(),[3,6];case 3:return t=n.sent(),[4,(0,f.dispatch)(Oe).unlock()];case 4:return n.sent(),[4,(0,ue.createErrorNotice)(t)];case 5:return n.sent(),[3,6];case 6:return[2]}}))}))}function be(e){return de(this,void 0,Promise,(function(){var t,n;return pe(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,8]),[4,(0,f.dispatch)(Oe).lock()];case 1:return r.sent(),[4,le({path:"/nab/v1/site/".concat(e,"/subscription"),method:"DELETE"})];case 2:return r.sent(),(null==(t=(0,f.select)(Oe).getSite(e))?void 0:t.isCurrentSite)?(window.location.reload(),[2]):[4,(0,f.dispatch)(Oe).unlock()];case 3:return r.sent(),[4,(0,f.dispatch)(Oe).removeSiteAfterUnlink(e)];case 4:case 7:return r.sent(),[3,8];case 5:return n=r.sent(),[4,(0,f.dispatch)(Oe).unlock()];case 6:return r.sent(),[4,(0,ue.createErrorNotice)(n)];case 8:return[2]}}))}))}function ge(){return de(this,void 0,Promise,(function(){var e,t;return pe(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,6]),[4,(0,f.dispatch)(Oe).lock()];case 1:return n.sent(),e=(0,f.select)(Oe).getSubscriptionId(),[4,le({path:"/nab/v1/subscription/".concat(e),method:"DELETE"})];case 2:return n.sent(),window.location.reload(),[3,6];case 3:return t=n.sent(),[4,(0,f.dispatch)(Oe).unlock()];case 4:return n.sent(),[4,(0,ue.createErrorNotice)(t)];case 5:return n.sent(),[3,6];case 6:return[2]}}))}))}function ve(){return de(this,void 0,Promise,(function(){var e,t;return pe(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,6]),[4,(0,f.dispatch)(Oe).lock()];case 1:return n.sent(),e=(0,f.select)(Oe).getSubscriptionId(),[4,le({path:"/nab/v1/subscription/".concat(e,"/uncancel"),method:"POST"})];case 2:return n.sent(),window.location.reload(),[3,6];case 3:return t=n.sent(),[4,(0,f.dispatch)(Oe).unlock()];case 4:return n.sent(),[4,(0,ue.createErrorNotice)(t)];case 5:return n.sent(),[3,6];case 6:return[2]}}))}))}function _e(e,t){return de(this,void 0,Promise,(function(){var n,r;return pe(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,6]),[4,(0,f.dispatch)(Oe).lock()];case 1:return a.sent(),n=(0,f.select)(Oe).getSubscriptionId(),[4,le({path:"/nab/v1/subscription/".concat(n),method:"PUT",data:{product:e,extraQuotaUnits:t}})];case 2:return a.sent(),window.location.reload(),[3,6];case 3:return r=a.sent(),[4,(0,f.dispatch)(Oe).unlock()];case 4:return a.sent(),[4,(0,ue.createErrorNotice)(r)];case 5:return a.sent(),[3,6];case 6:return[2]}}))}))}function he(e,t){return de(this,void 0,Promise,(function(){var n,r,a,i;return pe(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,5]),n=(0,f.select)(Oe).getSubscriptionId(),r=(0,f.select)(Oe).getSites(n),[4,le({path:"/nab/v1/site/".concat(e),method:"PUT",data:{maxMonthlyQuota:t}})];case 1:return a=o.sent(),[4,(0,f.dispatch)(Oe).receiveSites(r.map((function(e){return e.id===a.id?me(me(me({},e),a),{maxMonthlyQuota:t}):e})))];case 2:case 4:return o.sent(),[3,5];case 3:return i=o.sent(),[4,(0,ue.createErrorNotice)(i)];case 5:return[2]}}))}))}var Ee=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((r=r.apply(e,t||[])).next())}))},ye=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function xe(){return Ee(this,void 0,Promise,(function(){var e,t;return ye(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,5]),[4,le({path:"/nab/v1/account"})];case 1:return e=n.sent(),[4,(0,f.dispatch)(Oe).receiveAccount(e)];case 2:return n.sent(),[3,5];case 3:return t=n.sent(),[4,(0,ue.createErrorNotice)(t,(0,u._x)("Error while accessing site info.","text","nelio-ab-testing"))];case 4:throw n.sent(),t;case 5:return[2]}}))}))}function we(){return Ee(this,void 0,Promise,(function(){return ye(this,(function(e){switch(e.label){case 0:return[4,(t=Oe,(0,f.resolveSelect)(t)).getAccount()];case 1:return e.sent(),[2]}var t}))}))}function Ne(e){return Ee(this,void 0,Promise,(function(){var t,n;return ye(this,(function(r){switch(r.label){case 0:if(!e)return[2];r.label=1;case 1:return r.trys.push([1,4,,6]),[4,le({path:"/nab/v1/subscription/".concat(e,"/sites")})];case 2:return t=r.sent(),[4,(0,f.dispatch)(Oe).receiveSites(t)];case 3:return r.sent(),[3,6];case 4:return n=r.sent(),[4,(0,ue.createErrorNotice)(n,(0,u.sprintf)(/* translators: subscription id */ /* translators: subscription id */
(0,u._x)("Error while accessing sites in subscription %s.","text","nelio-ab-testing"),e))];case 5:throw r.sent(),n;case 6:return[2]}}))}))}function Se(e){return Ee(this,void 0,Promise,(function(){var t,n;return ye(this,(function(r){switch(r.label){case 0:if(!e)return[2];r.label=1;case 1:return r.trys.push([1,4,,6]),[4,le({path:"/nab/v1/subscription/".concat(e,"/invoices")})];case 2:return t=r.sent(),[4,(0,f.dispatch)(Oe).receiveInvoices(t)];case 3:return r.sent(),[3,6];case 4:return n=r.sent(),[4,(0,ue.createErrorNotice)(n,(0,u.sprintf)(/* translators: subscription id */ /* translators: subscription id */
(0,u._x)("Error while accessing invoices in subscription %s.","text","nelio-ab-testing"),e))];case 5:throw r.sent(),n;case 6:return[2]}}))}))}var Ce=function(){return Ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ce.apply(this,arguments)},ke=Ce(Ce({},a),i),Oe=(0,f.createReduxStore)("nab/account",{reducer:function(e,t){var n;return void 0===e&&(e=v),null!==(n=function(e,t){switch(t.type){case"RECEIVE_ACCOUNT":return _(_({},e),{account:t.account});case"RECEIVE_INVOICES":return _(_({},e),{invoices:t.invoices});case"RECEIVE_SITES":return _(_({},e),{sites:t.sites});case"UNLINK_SITE":return _(_({},e),{sites:(0,g.reject)(e.sites,{id:t.id})});case"LOCK_PAGE":return _(_({},e),{isPageLocked:!0});case"UNLOCK_PAGE":return _(_({},e),{isPageLocked:!1});case"ENABLE_AGENCY_FULL_VIEW":return _(_({},e),{isAgencyFullViewEnabled:!0})}}(e,t))&&void 0!==n?n:e},controls:f.controls,actions:ke,selectors:r,resolvers:o});!function(e){(0,f.register)(e)}(Oe);var Pe=function(e){var t=e.children,n=Ae(),r=De(),a=Ie(),i=(0,f.useDispatch)(l.store).removeNotice;return n?c.createElement(m.LoadingAnimation,{text:(0,u._x)("Loading…","text","nelio-ab-testing")}):c.createElement(c.Fragment,null,c.createElement(s.NoticeList,{notices:a,className:"components-editor-notices__pinned",onRemove:i}),!r&&t)},Ae=function(){return b((function(e){return e(Oe).getAccount(),!e(Oe).hasFinishedResolution("getAccount")}))},De=function(){return b((function(e){return e(Oe).hasResolutionFailed("getAccount")}))},Ie=function(){return b((function(e){return e(l.store).getNotices()}))};const Fe=window.nab.data,Le=window.nab.date;var Te=function(e){var t=e.siteId,n=b((function(e){return e(Oe).getProductDisplay()}));return c.createElement("div",{className:"nab-account-container__box nab-plan"},c.createElement("div",{className:"nab-plan__content"},c.createElement("h3",{className:"nab-plan__title"},n,c.createElement("span",{className:"nab-plan__period"},(0,u._x)("Agency Plan","text","nelio-ab-testing"))),c.createElement("div",{className:"nab-plan__renewal"},(0,u._x)("You’re currently using an agency subscription plan.","user","nelio-ab-testing")),c.createElement(m.QuotaMeter,null)),c.createElement("div",{className:"nab-plan__actions"},c.createElement(Ue,{siteId:t}),c.createElement(Be,null)))},Ue=function(e){var t=e.siteId,n=(0,c.useState)(!1),r=n[0],a=n[1],i=(0,f.useDispatch)(Oe).unlinkSite,o=function(){return a(!1)};return c.createElement(c.Fragment,null,c.createElement(s.Button,{isDestructive:!0,className:"nab-plan__action",onClick:function(){return a(!0)}},(0,u._x)("Downgrade to Free Version","command","nelio-ab-testing")),c.createElement(m.ConfirmationDialog,{title:(0,u._x)("Downgrade to Free version?","text","nelio-ab-testing"),text:(0,u._x)("This will remove the subscription license from the site and you’ll be using Nelio A/B Testing’s free version.","text","nelio-ab-testing"),confirmLabel:(0,u._x)("Downgrade","command","nelio-ab-testing"),isOpen:r,onCancel:o,onConfirm:function(){o(),i(t)}}))},Be=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1],r=(0,c.useState)(""),a=r[0],i=r[1],o=(0,c.useState)(!1),l=o[0],m=o[1],d=(0,f.useDispatch)(Oe),p=d.enableAgencyFullView,b=d.receiveAccount;return c.createElement("div",null,c.createElement(s.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,u._x)("View Details","command","nelio-ab-testing")),t&&c.createElement(s.Popover,{className:"nab-license-form",noArrow:!1,placement:"bottom"},c.createElement(s.TextControl,{value:a,placeholder:(0,u._x)("Type your license here","user","nelio-ab-testing"),className:"nab-license-form__text-control",onChange:function(e){return i((0,g.trim)(e))}}),c.createElement(s.Button,{variant:"primary",isBusy:l,className:"nab-license-form__button",onClick:function(){m(!0),le({path:"/nab/v1/account/agency",method:"POST",data:{license:a}}).then((function(e){b(e),p(),m(!1),n(!1)})).catch((function(){m(!1)}))},disabled:!a.length||l},l?(0,u._x)("Validating…","text","nelio-ab-testing"):(0,u._x)("Validate","command","nelio-ab-testing"))))},je=function(e){var t=e.isOpen,n=e.placement,r=e.onFocusOutside,a=Me(),i=Re(),o=i.addons,l=i.enabledAddons,d=(0,c.useState)(!1),p=d[0],g=d[1],v=(0,c.useState)(),_=v[0],h=v[1],E=Qe(),y=b((function(e){return e(Oe).isLocked()})),x=(0,f.useDispatch)(Oe),w=x.lock,N=x.unlock;if(p){if(!_)return null;var S=_.displayName,C=_.displayPrice;return c.createElement(m.ConfirmationDialog,{title:(0,u.sprintf)(/* translators: addon name */ /* translators: addon name */
(0,u._x)("Upgrade your subscription to include %s?","text","nelio-ab-testing"),S),text:(0,c.createInterpolateElement)((0,u.sprintf)(/* translators: 1 -> addon name, 2 -> addon price */ /* translators: 1 -> addon name, 2 -> addon price */
(0,u._x)("This will include the %1$s addon to your subscription for an additional charge of %2$s. You will be charged today.","text","nelio-ab-testing"),S,"<strong>".concat(C,"</strong>")),{strong:c.createElement("strong",null)}),confirmLabel:(0,u._x)("Upgrade Now","command","nelio-ab-testing"),isOpen:p,isConfirmBusy:y,onCancel:function(){return g(!1)},onConfirm:function(){w(),le({path:"/nab/v1/activate/recordings",method:"POST"}).then((function(){return window.location.reload()})).catch((function(e){return(0,ue.createErrorNotice)(e)})).finally((function(){N(),h(void 0),g(!1)}))}})}return t?a?c.createElement(s.Popover,{className:"nab-addons nab-addons--loading",noArrow:!1,placement:n,onFocusOutside:r},c.createElement(s.Spinner,null)):c.createElement(s.Popover,{className:"nab-addons",noArrow:!1,placement:n,onFocusOutside:r},c.createElement("div",{className:"nab-addons__container"},c.createElement("div",{className:"nab-addons__container-title"},(0,u._x)("Addons","text","nelio-ab-testing")),c.createElement("div",{className:"nab-addons__container-list"},o.map((function(e){var t=e.id,n=e.displayName,r=e.price,a=e.period;return c.createElement("div",{className:"nab-addons__product",key:t},c.createElement("div",{className:"nab-addons__product-details"},c.createElement("div",{className:"nab-addons__product-name"},qe(n)),!l.includes(t)&&c.createElement("div",{className:"nab-addons__product-price",title:E},Ve(r[E]||0,E,a))),c.createElement("div",{className:"nab-addons__product-action"},l.includes(t)?c.createElement("span",{className:"nab-addons__product--enabled"},(0,u._x)("Enabled","text","nelio-ab-testing")):c.createElement(s.Button,{variant:"primary",disabled:y,isBusy:y,onClick:function(){h({displayName:qe(n),displayPrice:Ve(r[E]||0,E,a)}),g(!0)}},(0,u._x)("Enable","text","nelio-ab-testing"))))}))),c.createElement(s.Button,{className:"screen-reader-text",onClick:r},(0,u._x)("Close addons","command","nelio-ab-testing")))):null},Me=function(){return b((function(e){return!e(Fe.store).hasFinishedResolution("getProducts")}))},Re=function(){return b((function(e){var t,n=e(Fe.store).getProducts,r=e(Oe),a=r.getSubscriptionProduct,i=r.getSubscriptionAddons,o=a(),c=i(),l=n(),s=(null===(t=l.find((function(e){return e.id===o})))||void 0===t?void 0:t.allowedAddons)||[];return{addons:l.filter((function(e){return e.isAddon&&s.includes(e.id)})),enabledAddons:c}}))},Qe=function(){return b((function(e){return e(Oe).getCurrency()||"USD"}))},Ve=function(e,t,n){var r="month"===n?(0,u._x)("/ month","text","nelio-ab-testing"):(0,u._x)("/ year","text","nelio-ab-testing"),a="EUR"===t?"".concat(e,"€"):"US$".concat(e);return"".concat(a," ").concat(r).trim()},qe=function(e){return(0,Le.getLocale)().startsWith("es")?e.es:e.en},Ye=function(e){var t=e.isOpen,n=e.placement,r=e.onClick,a=e.onFocusOutside,i=(0,c.useState)(""),o=i[0],l=i[1],m=(0,f.useDispatch)(Oe).linkSite;return t?c.createElement(s.Popover,{className:"nab-license-form",noArrow:!1,placement:n,onFocusOutside:a},c.createElement(s.TextControl,{value:o,placeholder:(0,u._x)("Type your license here","user","nelio-ab-testing"),maxLength:Math.max(21,26),className:"nab-license-form__text-control",onChange:function(e){return l((0,g.trim)(e))}}),c.createElement(s.Button,{variant:"primary",className:"nab-license-form__button",disabled:21!==o.length&&26!==o.length,onClick:function(){r(),m(o)}},(0,u._x)("Apply","command","nelio-ab-testing"))):null},Ge=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},Ke={monthly:{product:"nab-enterprise-monthly",quotaAddon:"nab-pageviews-monthly"},yearly:{product:"nab-enterprise-yearly",quotaAddon:"nab-pageviews-yearly"}},We=[Ke.monthly.product,Ke.yearly.product],$e=2e5,He=[0,2,4,6,11,16],ze=function(e){var t=e.back,n=e.isOpen,r=e.placement,a=e.onClick,i=e.onFocusOutside,o=Je(),l=Xe(),m=et(),d=m.wasYearly,p=m.previousAddonQuantity,b=at(Ge([p],He.filter((function(e){return e>p})),!0),7),g=(0,c.useState)(b[0]),v=g[0],_=g[1],h=(0,c.useState)(d),E=h[0],y=h[1],x=Ze(E?"yearly":"monthly",v),w=d?"/"+(0,u._x)("year","text","nelio-ab-testing"):"",N=(0,f.useDispatch)(Oe).upgradeSubscription;return n?We.some((function(e){return!l.map((function(e){return e.id})).includes(e)}))?c.createElement(s.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form nab-enterprise-upgrade-form--error",noArrow:!1,placement:r,onFocusOutside:i},c.createElement("p",null,(0,u._x)("Something went wrong while retrieving plans. Please contact Nelio support.","user","nelio-ab-testing"))):o?c.createElement(s.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form--loading",noArrow:!1,placement:r,onFocusOutside:i},c.createElement(s.Spinner,null)):c.createElement(s.Popover,{className:"nab-enterprise-upgrade-form",noArrow:!1,placement:r,onFocusOutside:i},c.createElement("div",{className:"nab-enterprise-upgrade-form__container"},c.createElement("h3",null,(0,u.sprintf)("Enterprise%1$s",x?" (".concat(x).concat(w,")"):"")),c.createElement(s.SelectControl,{label:(0,u._x)("Monthly Page Views","text","nelio-ab-testing"),value:"".concat(v),options:b.map((function(e){return{value:"".concat(e),label:rt($e+5e4*e)}})),onChange:function(e){return _(Number.parseInt(e))},help:p>=0?(0,u.sprintf)(/* translators: number of page views */ /* translators: number of page views */
(0,u._x)("Currently set to %s","text","nelio-ab-testing"),rt($e+5e4*p)):void 0}),!d&&c.createElement(s.CheckboxControl,{checked:E,onChange:function(e){return y(e)},label:(0,u._x)("Pay yearly","command","nelio-ab-testing")})),c.createElement("div",{className:"nab-enterprise-upgrade-form__button-container"},t&&c.createElement(s.Button,{variant:"secondary",className:"nab-enterprise-upgrade-form__button",onClick:t},(0,u._x)("Back","command","nelio-ab-testing")),c.createElement(s.Button,{variant:"primary",className:"nab-enterprise-upgrade-form__button",onClick:function(){a(),N(E?Ke.yearly.product:Ke.monthly.product,v)}},(0,u._x)("Upgrade Subscription","command (subscription)","nelio-ab-testing")))):null},Je=function(){return b((function(e){return!e(Fe.store).hasFinishedResolution("getProducts")}))},Xe=function(){return b((function(e){return e(Fe.store).getProducts()}))},Ze=function(e,t){return b((function(n){var r,a=n(Fe.store).getProducts(),i=n(Oe).getCurrency()||"USD",o=a.find((function(t){return t.id===Ke[e].product})),c=a.find((function(t){return t.id===Ke[e].quotaAddon}));if(!o||!c)return"";var l=function(e){var t,n;return null!==(n=null!==(t=e.price[i])&&void 0!==t?t:e.price.USD)&&void 0!==n?n:0},s=(0,g.toPairs)(null!==(r=c.quantityDiscounts)&&void 0!==r?r:{}).map((function(e){var t=e[0],n=e[1];return[Number.parseInt(t),n]})).reduce((function(e,n){var r=n[0],a=n[1];return r<=t?a:e}),0)/100,u=l(o)+l(c)*t*(1-s);return nt(u,i)}))},et=function(){return b((function(e){return{wasYearly:"year"===e(Oe).getPeriod(),previousAddonQuantity:"enterprise"!==e(Oe).getPlan()?-1:e(Oe).getExtraQuotaUnits()}}))},tt=function(){try{return new Intl.NumberFormat((0,Le.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}}(),nt=function(e,t){return"EUR"===t?"".concat(tt.format(Math.ceil(e)),"€"):"USD".concat(tt.format(Math.ceil(e)))},rt=function(e){return tt.format(e)},at=function(e,t){var n,r=e[e.length-1]||0,a=Ge(Ge([],e,!0),(0,g.range)(1,t).map((function(e){return r+20*e})),!0).slice(1,t);return Ge([null!==(n=a[0])&&void 0!==n?n:0],a.slice(1),!0)},it=function(){return it=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},it.apply(this,arguments)},ot=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},ct=function(e){var t=e.isOpen,n=e.placement,r=e.onClick,a=e.onFocusOutside,i=e.showEnterprise,o=lt(),l=st(),m=ut(),d=(0,f.useDispatch)(Oe).upgradeSubscription,p=(0,c.useState)(""),b=p[0],g=p[1];return t?o?c.createElement(s.Popover,{className:"nab-regular-upgrade-form nab-regular-upgrade-form--loading",noArrow:!1,placement:n,onFocusOutside:a},c.createElement(s.Spinner,null)):c.createElement(s.Popover,{className:"nab-regular-upgrade-form",noArrow:!1,placement:n,onFocusOutside:a},c.createElement("div",{className:"nab-regular-upgrade-form__product-container"},c.createElement("h3",null,(0,u._x)("Subscription Plans","text","nelio-ab-testing")),c.createElement(s.RadioControl,{selected:b,options:l.map((function(e){var t=e.id,n=e.displayName,r=e.price,a=e.description,i=e.enabledAddons;return{label:c.createElement("div",{className:"nab-regular-upgrade-form__product"},c.createElement("strong",{className:"nab-regular-upgrade-form__product-name"},pt(n)),c.createElement("span",{className:"nab-regular-upgrade-form__product-price",title:m},dt(t,(r[m]||0)+i.reduce((function(e,t){return e+(t.price[m]||0)}),0),m)),c.createElement("span",{className:"nab-regular-upgrade-form__product-description"},pt(a))),value:t}})),onChange:function(e){e&&("nab-enterprise-placeholder"!==e?g(e):i())}})),c.createElement("div",{className:"nab-regular-upgrade-form__button-container"},c.createElement(s.Button,{variant:"primary",className:"nab-regular-upgrade-form__button",disabled:!b,onClick:function(){r(),d(b,0)}},(0,u._x)("Upgrade Subscription","command","nelio-ab-testing")))):null},lt=function(){return b((function(e){return!e(Fe.store).hasFinishedResolution("getProducts")}))},st=function(){return b((function(e){var t,n=e(Fe.store).getProducts,r=e(Oe),a=r.getSubscriptionProduct,i=r.getSubscriptionAddons,o=a(),c=n(),l=c.filter((function(e){return e.upgradeableFrom.includes(o)})),s=l.filter((function(e){return!e.id.includes("enterprise")})),u=l.find((function(e){return e.id.includes("enterprise-monthly")}))||l.find((function(e){return e.id.includes("enterprise-yearly")})),m=i(),d=c.filter((function(e){return e.isAddon})),p=function(e){var t;return(null!==(t=null==e?void 0:e.allowedAddons)&&void 0!==t?t:[]).filter((function(e){return!!m.find((function(t){return ft(e,t)}))})).map((function(e){return d.find((function(t){return t.id===e}))})).filter((function(e){return!!e}))};return ot(ot([],s.map((function(e){return it(it({},e),{enabledAddons:p(e)})})),!0),[it(it({price:{USD:0,EUR:0},description:{en:"",es:""},enabledAddons:p(u)},u),{id:"nab-enterprise-placeholder",displayName:(0,g.mapValues)(null!==(t=null==u?void 0:u.displayName)&&void 0!==t?t:{en:"",es:""},(function(e){return(0,g.trim)(e.replace(/\([^)]*\)/,""))}))})],!1)}))},ut=function(){return b((function(e){return e(Oe).getCurrency()||"USD"}))},mt=function(){try{return new Intl.NumberFormat((0,Le.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}}(),dt=function(e,t,n){var r="EUR"===n?"".concat(mt.format(Math.ceil(t)),"€"):"USD".concat(mt.format(Math.ceil(t)));return"nab-enterprise-placeholder"===e?(0,u.sprintf)(/* translators: price */ /* translators: price */
(0,u._x)("starting from %s","text (money)","nelio-ab-testing"),r):r},pt=function(e){return(0,Le.getLocale)().startsWith("es")?e.es.replace("de Nelio A/B Testing",""):e.en.replace("Nelio A/B Testing","")},ft=function(e,t){var n=e.substring(0,e.indexOf("addon-")),r=t.substring(0,t.indexOf("addon-"));return!!n&&!!r&&n===r},bt=function(){return bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},bt.apply(this,arguments)},gt=function(e){var t=b((function(e){return e(Oe).getPlan()})),n=(0,c.useState)(!1),r=n[0],a=n[1];return"enterprise"===t||r?c.createElement(ze,bt({back:"enterprise"!==t&&function(){return a(!1)}},e)):c.createElement(ct,bt({showEnterprise:function(){return a(!0)}},e))},vt=function(e){var t=e.siteId,n=Qt();return Tt()?c.createElement(Te,{siteId:t}):c.createElement("div",{className:"nab-account-container__box nab-plan"},c.createElement("div",{className:"nab-plan__content"},c.createElement(_t,null),c.createElement(ht,null),c.createElement(m.QuotaMeter,{disabled:n.isLoading,subscriptionQuota:n.data})),c.createElement(Et,null))},_t=function(){var e=At().period,t=Ut(),n=Dt(),r=Ft(),a="month"===e?(0,u._x)("Monthly","text","nelio-ab-testing"):(0,u._x)("Yearly","text","nelio-ab-testing");return c.createElement("h3",{className:"nab-plan__title"},t,c.createElement("span",{className:"nab-plan__period"},r?(0,u._x)("Free","text","nelio-ab-testing"):a),"canceled"===n&&c.createElement("span",{className:"nab-plan__state"},(0,u._x)("Canceled","text (account state)","nelio-ab-testing")))},ht=function(){var e=Ft(),t=Lt(),n=Dt(),r=It(),a=Bt(),i=jt(),o=Mt();return e?c.createElement("div",{className:"nab-plan__renewal"},(0,u._x)("You are using the free version of Nelio A/B Testing.","text","nelio-ab-testing")):t?c.createElement("div",{className:"nab-plan__renewal"},(0,c.createInterpolateElement)((0,u.sprintf)(/* translators: 1 -> price and currency; 2 -> date */ /* translators: 1 -> price and currency; 2 -> date */
(0,u._x)("You’re currently using a premium version of Nelio A/B Testing for free. This invitation will end on %s and the plugin will be downgraded to a free plan. Please consider subscribing before that.","user","nelio-ab-testing"),"<date>".concat((0,Le.formatI18nDate)(i),"</date>")),{date:c.createElement("span",{className:"nab-plan__renewal-date"})})):"canceled"===n?c.createElement("div",{className:"nab-plan__renewal"},(0,c.createInterpolateElement)((0,u.sprintf)(/* translators: date */ /* translators: date */
(0,u._x)("Your subscription will end on %s.","text","nelio-ab-testing"),"<date>".concat((0,Le.formatI18nDate)(a),"</date>")),{date:c.createElement("span",{className:"nab-plan__renewal-date"})})):r?c.createElement("div",{className:"nab-plan__renewal"},(0,c.createInterpolateElement)((0,u._x)("<link>Contact us</link> to get additional features to manage your account.","text","nelio-ab-testing"),{link:c.createElement("a",{href:"mailto:support@neliosoftware.com"})})):c.createElement("div",{className:"nab-plan__renewal"},(0,c.createInterpolateElement)((0,u.sprintf)(/* translators: 1 -> price and currency; 2 -> date */ /* translators: 1 -> price and currency; 2 -> date */
(0,u._x)("Next charge will be %1$s on %2$s.","text","nelio-ab-testing"),"<money>".concat(o,"</money>"),"<date>".concat((0,Le.formatI18nDate)(i),"</date>")),{date:c.createElement("span",{className:"nab-plan__renewal-date"}),money:c.createElement("span",{className:"nab-plan__renewal-amount"})}))},Et=function(){var e=Ft(),t=Lt(),n=Dt();return It()?c.createElement("div",{className:"nab-plan__actions"},c.createElement(wt,null),c.createElement(Nt,null)):e||t?c.createElement("div",{className:"nab-plan__actions"},c.createElement(yt,null),c.createElement(xt,null)):"canceled"===n?c.createElement("div",{className:"nab-plan__actions"},c.createElement(Pt,null)):c.createElement("div",{className:"nab-plan__actions nab-plan__actions--separated"},c.createElement(St,null),c.createElement("div",{className:"nab-plan__actions-group"},c.createElement(Ct,null),c.createElement(kt,null),c.createElement(Ot,null)))},yt=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1];return c.createElement("span",{className:"nab-plan__action-container"},c.createElement(s.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,u._x)("Use License","command","nelio-ab-testing")),c.createElement(Ye,{placement:"bottom",onFocusOutside:function(){return n(!1)},onClick:function(){return n(!1)},isOpen:t}))},xt=function(){var e=Rt();return c.createElement(s.ExternalLink,{className:"nab-plan__action components-button is-primary",href:(0,ue.getSubscribeLink)(e)},(0,ue.getSubscribeLabel)(e))},wt=function(){return"enterprise"===At().plan?null:c.createElement(s.ExternalLink,{className:"nab-plan__action components-button is-secondary",href:"mailto:support@neliosoftware.com?subject=Buy%20Quota"},(0,u._x)("Buy More Quota","command","nelio-ab-testing"))},Nt=function(){return c.createElement(s.ExternalLink,{className:"nab-plan__action components-button is-primary",href:"mailto:support@neliosoftware.com?subject=Upgrade%20Subscription"},(0,u._x)("Upgrade Subscription","command","nelio-ab-testing"))},St=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1],r=(0,f.useDispatch)(Oe).cancelSubscription,a=jt();return c.createElement(c.Fragment,null,c.createElement(s.Button,{isDestructive:!0,className:"nab-plan__action",onClick:function(){return n(!0)}},(0,u._x)("Cancel Subscription","command","nelio-ab-testing")),c.createElement(m.ConfirmationDialog,{title:(0,u._x)("Cancel Subscription?","text","nelio-ab-testing"),text:(0,u.sprintf)(/* translators: a date */ /* translators: a date */
(0,u._x)("Canceling your subscription will cause it not to renew. If you cancel your subscrition, it will continue until %s. Then, the subscription will expire and will not be invoiced again. Do you want to cancel your subscription?","user","nelio-ab-testing"),(0,Le.formatI18nDate)(a)),isDestructive:!0,confirmLabel:(0,u._x)("Cancel Subscription","command","nelio-ab-testing"),cancelLabel:(0,u._x)("Back","command","nelio-ab-testing"),onCancel:function(){return n(!1)},onConfirm:function(){n(!1),r()},isOpen:t}))},Ct=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1];return"enterprise"===At().plan?null:c.createElement("div",null,c.createElement(s.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,u._x)("Buy More Quota","command","nelio-ab-testing")),c.createElement(m.QuotaPurchasePopover,{placement:"bottom",onClick:function(){return n(!1)},onFocusOutside:function(){return n(!1)},isOpen:t}))},kt=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1];return c.createElement("div",null,c.createElement(s.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,u._x)("Addons","text","nelio-ab-testing")),c.createElement(je,{placement:"bottom",onFocusOutside:function(){return n(!1)},isOpen:t}))},Ot=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1];return c.createElement("div",null,c.createElement(s.Button,{variant:"primary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,u._x)("Upgrade Subscription","command","nelio-ab-testing")),c.createElement(gt,{placement:"bottom",onClick:function(){return n(!1)},onFocusOutside:function(){return n(!1)},isOpen:t}))},Pt=function(){var e=(0,c.useState)(!1),t=e[0],n=e[1],r=(0,f.useDispatch)(Oe).uncancelSubscription,a=jt();return c.createElement(c.Fragment,null,c.createElement(s.Button,{variant:"primary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,u._x)("Reactivate Subscription","command","nelio-ab-testing")),c.createElement(m.ConfirmationDialog,{title:(0,u._x)("Reactivate Subscription?","text","nelio-ab-testing"),text:(0,u.sprintf)(/* translators: a date */ /* translators: a date */
(0,u._x)("Reactivating your subscription will cause it to renew on %s. Do you want to reactivate your subscription?","user","nelio-ab-testing"),(0,Le.formatI18nDate)(a)),confirmLabel:(0,u._x)("Reactivate Subscription","command","nelio-ab-testing"),cancelLabel:(0,u._x)("Back","command","nelio-ab-testing"),onCancel:function(){return n(!1)},onConfirm:function(){n(!1),r()},isOpen:t}))},At=function(){return b((function(e){return{period:e(Oe).getPeriod(),plan:e(Oe).getPlan()}}))},Dt=function(){return b((function(e){return e(Oe).getState()}))},It=function(){return b((function(e){return e(Oe).isSubscriptionDeprecated()}))},Ft=function(){return b((function(e){return"free"===e(Oe).getMode()}))},Lt=function(){return b((function(e){return"invitation"===e(Oe).getMode()}))},Tt=function(){return b((function(e){return e(Oe).isAgency()&&!e(Oe).isAgencyFullViewEnabled()}))},Ut=function(){return b((function(e){return e(Oe).getProductDisplay()}))},Bt=function(){return b((function(e){return e(Oe).getDeactivationDate()||e(Fe.store).getToday()}))},jt=function(){return b((function(e){return e(Oe).getNextChargeDate()||e(Fe.store).getToday()}))},Mt=function(){return b((function(e){return e(Oe).getNextChargeTotal()}))},Rt=function(){return b((function(e){return e(Fe.store).getToday()}))},Qt=function(){return b((function(e){return{data:e(Oe).getSubscriptionQuota(),isLoading:!e(Oe).hasFinishedResolution("getSubscriptionQuota")}}))},Vt=function(){return Vt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Vt.apply(this,arguments)},qt=function(e){var t=e.label,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["label"]),r=(0,c.useState)(!1),a=r[0],i=r[1],o=b((function(e){return e(Fe.store).getPluginSetting("siteId")})),l=b((function(e){return e(Oe).isLocked()})),d=(0,f.useDispatch)(Oe).unlinkSite;return c.createElement(c.Fragment,null,c.createElement(s.Button,Vt({onClick:function(){return i(!0)},disabled:l},n),t),c.createElement(m.ConfirmationDialog,{title:(0,u._x)("Downgrade to Free Version?","text","nelio-ab-testing"),text:(0,u._x)("This action will remove the license from this site so that you can use it somewhere else. Nelio A/B Testing will remain active on this site, but you will be using the free version instead. Do you want to continue?","user","nelio-ab-testing"),confirmLabel:(0,u._x)("Downgrade","command (remove license)","nelio-ab-testing"),cancelLabel:(0,u._x)("Back","command","nelio-ab-testing"),isDestructive:!0,onCancel:function(){return i(!1)},onConfirm:function(){d(o),i(!1)},isOpen:a}))},Yt=function(){var e=Gt(),t=Kt(),n=Wt(),r=$t(),a=Ht(),i=zt(),o=(0,c.useState)(!1),l=o[0],m=o[1];return e?c.createElement("div",{className:"nab-account-container__box nab-info"},c.createElement("h3",{className:"nab-info__title"},(0,u._x)("Account Information","title (account)","nelio-ab-testing")),c.createElement("div",{className:"nab-info__container"},c.createElement("div",{className:"nab-info__profile"},c.createElement("div",{className:"nab-info__picture nab-first-letter-a"},c.createElement("div",{className:"nab-info__actual-picture",style:{backgroundImage:"url(".concat(i,")")}}))),c.createElement("div",{className:"nab-info__details"},c.createElement("p",{className:"nab-info__name"},t),c.createElement("p",{className:"nab-info__email"},c.createElement(s.Dashicon,{icon:"email",className:"nab-info__icon"}),n),c.createElement("p",{className:"nab-info__creation-date"},c.createElement(s.Dashicon,{icon:"calendar",className:"nab-info__icon"}),(0,c.createInterpolateElement)((0,u.sprintf)(/* translators: date */ /* translators: date */
(0,u._x)("Member since %s.","text","nelio-ab-testing"),"<date>".concat((0,Le.formatI18nDate)(r),"</date>")),{date:c.createElement("strong",null)})),c.createElement("div",{className:"nab-info__license"},c.createElement(s.Dashicon,{icon:"admin-network",className:"nab-info__icon"}),c.createElement("code",{title:(0,u._x)("License Key","text","nelio-ab-testing")},a),c.createElement("div",{className:"nab-info__change-license"},c.createElement(s.Button,{variant:"link",onClick:function(){return m(!0)}},(0,u._x)("Change","command","nelio-ab-testing")),c.createElement(Ye,{isOpen:l,placement:"bottom",onClick:function(){return m(!1)},onFocusOutside:function(){return m(!1)}})),c.createElement("div",{className:"nab-info__remove-license"},c.createElement(qt,{variant:"link",isDestructive:!0,label:(0,u._x)("Remove","command","nelio-ab-testing")})))))):null},Gt=function(){return b((function(e){var t=e(Oe),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i="regular"===n(),o=r()&&!a();return i&&!o}))},Kt=function(){return b((function(e){return e(Oe).getFullname()}))},Wt=function(){return b((function(e){return e(Oe).getEmail()}))},$t=function(){return b((function(e){return e(Oe).getStartDate()||e(Fe.store).getToday()}))},Ht=function(){return b((function(e){return e(Oe).getLicense()}))},zt=function(){return b((function(e){return e(Oe).getPhoto()}))},Jt=n(6942),Xt=n.n(Jt);const Zt=window.nab.i18n;var en=function(e){var t=e.displayQuotaLimit,n=e.actualUrl,r=e.id,a=e.isCurrentSite,i=e.usedMonthlyQuota,o=e.maxMonthlyQuota,l=e.url;return c.createElement("li",{className:"nab-site"},c.createElement("span",{className:"nab-site__details"},a?c.createElement("span",{className:"nab-site__url"},c.createElement("span",{className:"nab-site__current-site"},n,!!n&&l!==n&&c.createElement(m.HelpIcon,{className:"nab-site__current-site-help",type:"info",text:(0,u.sprintf)(/* translators: site URL */ /* translators: site URL */
(0,u._x)("Activation URL is “%s”","text","nelio-ab-testing"),l)})),c.createElement("span",{className:"nab-site__label"},(0,u._x)("This site","text","nelio-ab-testing"))):c.createElement("span",{className:"nab-site__url"},c.createElement("a",{href:l,className:Xt()("nab-site__link",{"nab-site__link--current":a}),target:"_blank",rel:"noopener noreferrer"},l)),!!t&&c.createElement("small",null,c.createElement("strong",null,(0,u._x)("Quota Usage","text","nelio-ab-testing"),": "),(0,Zt.numberFormat)(i)," / ",an(o))),c.createElement(tn,{siteId:r}),c.createElement(nn,{siteId:r}))},tn=function(e){var t=e.siteId,n=(0,c.useState)(!1),r=n[0],a=n[1],i=b((function(e){return e(Fe.store).canLimitSiteQuota()})),o=(0,f.useDispatch)(Oe).limitSiteQuota,l=b((function(e){var n,r;return null!==(r=null===(n=e(Oe).getSite(t))||void 0===n?void 0:n.maxMonthlyQuota)&&void 0!==r?r:-1}));return i?c.createElement(c.Fragment,null,c.createElement(s.Button,{variant:"tertiary",className:"nab-site__limit-quota-button",onClick:function(){return a(!0)}},(0,u._x)("Limit Quota","command","nelio-ab-testing")),r&&c.createElement(rn,{initialValue:"".concat(l),onClose:function(){return a(!1)},onSave:function(e){return o(t,e)}})):null},nn=function(e){var t=e.siteId,n=(0,c.useState)(!1),r=n[0],a=n[1],i=(0,f.useDispatch)(Oe).unlinkSite;return c.createElement(c.Fragment,null,c.createElement(s.Button,{isDestructive:!0,variant:"tertiary",className:"nab-site__unlink-button",onClick:function(){return a(!0)}},(0,u._x)("Unlink Site","command","nelio-ab-testing")),c.createElement(m.ConfirmationDialog,{title:(0,u._x)("Unlink Site?","text","nelio-ab-testing"),text:(0,u._x)("This will remove the subscription license from the site.","text","nelio-ab-testing"),confirmLabel:(0,u._x)("Unlink","command","nelio-ab-testing"),isOpen:r,onCancel:function(){return a(!1)},onConfirm:function(){a(!1),i(t)}}))},rn=function(e){var t=e.initialValue,n=e.onClose,r=e.onSave,a=(0,c.useState)(!1),i=a[0],o=a[1],l=(0,c.useState)(t),m=l[0],d=l[1],p=m!==t;return c.createElement(s.Modal,{className:"site-quota-dialog",title:(0,u._x)("Site Quota","text","nelio-ab-testing"),onRequestClose:g.noop,isDismissible:!1},c.createElement(s.CheckboxControl,{checked:"-1"!==m,onChange:function(e){return d(e?"1000":"-1")},label:(0,u._x)("Limit quota usage in this site","command","nelio-ab-testing")}),"-1"!==m&&c.createElement(s.TextControl,{type:"number",min:"0",value:m,onChange:d}),c.createElement("div",{className:"site-quota-dialog__actions"},c.createElement(s.Button,{variant:"secondary",onClick:n},p?(0,u._x)("Discard Changes","command","nelio-ab-testing"):(0,u._x)("Close","command","nelio-ab-testing")),c.createElement(s.Button,{variant:"primary",onClick:function(){var e=Number.parseInt(m),t=-1===e?-1:Math.abs(e);o(!0),r(t).then(n).catch((function(){return o(!1)}))},disabled:!p||i},i?(0,u._x)("Saving…","text","nelio-ab-testing"):(0,u._x)("Save","command","nelio-ab-testing"))))},an=function(e){return-1===e?"∞":(0,Zt.numberFormat)(e)},on=function(){return on=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},on.apply(this,arguments)},cn=function(){var e=sn(),t=ln(),n=un(),r=mn();if(!e)return null;var a=n.length,i=n.length>1||n.some((function(e){return 0<=e.maxMonthlyQuota}));return c.createElement("div",{className:"nab-account-container__box nab-sites"},c.createElement("h3",{className:"nab-sites__title"},(0,u._x)("Sites","text","nelio-ab-testing"),t&&c.createElement(s.Spinner,null),c.createElement("span",{className:"nab-sites__availability"},"".concat(a," / ").concat(r))),c.createElement("ul",{className:"nab-sites__list"},!t&&n.map((function(e){return c.createElement(en,on({key:e.id,displayQuotaLimit:i},e))}))))},ln=function(){return b((function(e){return!e(Oe).hasFinishedResolution("getSites",[e(Oe).getSubscriptionId()])}))},sn=function(){return b((function(e){var t=e(Oe),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i="regular"===n(),o=r()&&!a();return i&&!o}))},un=function(){return b((function(e){return e(Oe).getSites(e(Oe).getSubscriptionId())||[]}))},mn=function(){return b((function(e){return"enterprise"===e(Oe).getPlan()?"∞":e(Oe).getSitesAllowed()}))},dn=function(e){var t=e.invoiceUrl,n=e.reference,r=e.chargeDate,a=e.isRefunded,i=e.subtotalDisplay;return c.createElement("tr",{className:"nab-invoice"},c.createElement("td",{className:"nab-invoice__reference"},c.createElement("a",{href:t,className:"nab-invoice__link",target:"_blank",rel:"noopener noreferrer"},n)),c.createElement("td",{className:"nab-invoice__date"},r),c.createElement("td",{className:"nab-invoice__total"},a&&c.createElement("span",{className:"nab-invoice__label"},(0,u._x)("(Refunded)","text (invoice)","nelio-ab-testing")),c.createElement("span",{className:Xt()("nab-invoice__total-value",{"nab-invoice__total-value--refunded":a})},i)))},pn=function(){return pn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},pn.apply(this,arguments)},fn=function(){var e=bn(),t=gn(),n=vn(),r=hn();return e?c.createElement("div",{className:"nab-account-container__box nab-billing"},c.createElement("h3",{className:"nab-billing__title"},(0,u._x)("Billing History","text","nelio-ab-testing"),t&&c.createElement(s.Spinner,null)),!t&&c.createElement(c.Fragment,null,c.createElement(s.ExternalLink,{className:"nab-billing__action",href:r},(0,u._x)("Manage Payments","user","nelio-ab-testing")),c.createElement("table",{className:"nab-billing__container"},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",{className:"nab-billing__reference"},(0,u._x)("Invoice Reference","text (account, billing table title)","nelio-ab-testing")),c.createElement("th",{className:"nab-billing__date"},(0,u._x)("Date","text (account, billing table title)","nelio-ab-testing")),c.createElement("th",{className:"nab-billing__total"},(0,u._x)("Total","text (account, billing table title)","nelio-ab-testing")))),c.createElement("tbody",{className:"invoice-list"},n.map((function(e){return c.createElement(dn,pn({key:e.reference},e))})))))):null},bn=function(){return b((function(e){var t=e(Oe),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i=t.isSubscriptionDeprecated,o="regular"===n(),c=i(),l=r()&&!a();return o&&!c&&!l}))},gn=function(){return b((function(e){return!e(Oe).hasFinishedResolution("getInvoices",[e(Oe).getSubscriptionId()])}))},vn=function(){return b((function(e){return e(Oe).getInvoices(e(Oe).getSubscriptionId())}))},hn=function(){return b((function(e){return e(Oe).getUrlToManagePayments()}))},En=function(){return b((function(e){return e(Oe).isLocked()}))?c.createElement(s.Modal,{className:"nab-locked",title:(0,u._x)("Loading…","text","nelio-ab-testing"),shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,isDismissible:!1,onRequestClose:g.noop},c.createElement(s.Spinner,null)):null},yn=function(e){var t=e.siteId;return c.createElement("div",{className:"nab-account-container"},c.createElement(vt,{siteId:t}),c.createElement(Yt,null),c.createElement(cn,null),c.createElement(fn,null),c.createElement(En,null))};function xn(e,t){var n,r,a=t.siteId,i=t.isSubscribed,o=document.getElementById(e);n=c.createElement(s.SlotFillProvider,null,c.createElement(p,{isSubscribed:i,siteId:a}),c.createElement(Pe,null,c.createElement(yn,{siteId:a})),c.createElement(s.Popover.Slot,null)),(r=o)&&(c.createRoot?(0,c.createRoot)(r).render(n):(0,c.render)(n,r)),(0,m.appendContextualHelp)({screen:"account",questions:d})}},6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,a,i)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],i=e[u][2];for(var c=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(c=!1,i<o&&(o=i));if(c){e.splice(u--,1);var s=a();void 0!==s&&(t=s)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,a,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={4808:0,4501:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,o=n[0],c=n[1],l=n[2],s=0;if(o.some((t=>0!==e[t]))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(l)var u=l(r)}for(t&&t(n);s<o.length;s++)i=o[s],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(u)},n=self.webpackChunknab=self.webpackChunknab||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[4501],(()=>r(9508)));a=r.O(a);var i=nab="undefined"==typeof nab?{}:nab;for(var o in a)i[o]=a[o];a.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();