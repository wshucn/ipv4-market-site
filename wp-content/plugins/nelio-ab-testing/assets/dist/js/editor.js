(()=>{var e,t={5802:(e,t,n)=>{"use strict";n.r(t),n.d(t,{editor:()=>o});var r={};n.r(r),n.d(r,{getActiveGoal:()=>F,getActiveGoalIndex:()=>H,getActiveSegment:()=>W,getActiveSegmentIndex:()=>Y,getAlternative:()=>M,getAlternativeIds:()=>V,getAlternativePreviewerUrl:()=>z,getAlternatives:()=>L,getConversionActions:()=>U,getDraftStatusRationale:()=>X,getExperimentAttribute:()=>$,getExperimentId:()=>J,getExperimentType:()=>Q,getGoals:()=>ee,getHeatmapAttribute:()=>K,getScope:()=>te,getSegmentEvaluation:()=>ie,getSegmentationRules:()=>re,getSegments:()=>ne,hasExperimentBeenRecentlySaved:()=>q,isExperimentBeingSaved:()=>j,isTestedElementInvalid:()=>Z});var i={};n.r(i),n.d(i,{addAlternatives:()=>ae,addConversionActionsIntoGoal:()=>ue,addGoals:()=>Se,addSegmentationRulesIntoSegment:()=>Ce,addSegments:()=>Te,closeAlternativePreviewer:()=>he,openAlternativePreviewer:()=>xe,removeAlternatives:()=>oe,removeConversionActionsFromGoal:()=>me,removeGoals:()=>Ae,removeSegmentationRulesFromSegment:()=>ke,removeSegments:()=>Re,replaceAlternatives:()=>se,replaceConversionActionsInGoal:()=>ce,replaceSegmentationRulesInSegment:()=>De,setActiveGoal:()=>ve,setActiveSegment:()=>ge,setAlternative:()=>le,setDraftStatusRationale:()=>be,setExperimentAsBeingSaved:()=>fe,setExperimentAsRecentlySaved:()=>Ee,setExperimentData:()=>ye,setHeatmapData:()=>_e,setScopeRules:()=>Ie,setSegmentEvaluation:()=>Ge,setTestedElementAsInvalid:()=>we,setupEditor:()=>pe,updateConversionAction:()=>de,updateGoal:()=>Ne,updateSegment:()=>Oe,updateSegmentationRule:()=>Pe});var a={};n.r(a),n.d(a,{moveToTrash:()=>Ze,resumeExperiment:()=>tt,saveExperiment:()=>Qe,saveExperimentAndEditAlternative:()=>$e,saveExperimentAndPreviewAlternative:()=>Ke,startExperiment:()=>et});var o={};n.r(o),n.d(o,{EditorProvider:()=>ut,ExperimentName:()=>Yt,Header:()=>Mt,Sidebar:()=>ui,initializeExperimentEditor:()=>Gi,store:()=>lt});const s=window.wp.element;window.wp.coreData;const l=window.wp.data;function u(e,t){return(0,l.useSelect)(e,t)}const c=window.wp.domReady,m=n.n(c)(),d=window.lodash,p=window.nab.conversionActionLibrary,v=window.nab.data,g=window.nab.experimentLibrary,f=window.nab.segmentationRuleLibrary,b=window.nab.utils;var E=function(){return E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E.apply(this,arguments)},x={activeGoalId:"",activeSegmentId:"",alternativePreviewerUrl:"",draftStatusRationale:"",hasExperimentBeenRecentlySaved:!1,isExperimentBeingSaved:!1},h=function(){return h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h.apply(this,arguments)},y=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},_={byId:{control:{id:"control",attributes:{},links:{edit:"",heatmap:"",preview:""}}},allIds:[]},w=function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},w.apply(this,arguments)},S={},A=function(){return A=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)},N={id:0,type:"",status:"draft",name:"",description:"",startDate:"",endDate:"",endMode:"manual",endValue:0,autoAlternativeApplication:!1,isTestedElementInvalid:!1,links:{edit:"",preview:""}},I=function(){return I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},I.apply(this,arguments)},T={},R={},O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O.apply(this,arguments)},C={evaluation:"tested-page",rules:{},segments:{}};const D=(0,l.combineReducers)({editor:function(e,t){var n;return void 0===e&&(e=x),null!==(n=function(e,t){switch(t.type){case"SET_ACTIVE_GOAL":return E(E({},e),{activeGoalId:t.goalId});case"SET_ACTIVE_SEGMENT":return E(E({},e),{activeSegmentId:t.segmentId});case"SET_EXPERIMENT_AS_BEING_SAVED":return E(E({},e),{isExperimentBeingSaved:!!t.status});case"SET_EXPERIMENT_AS_RECENTLY_SAVED":return E(E({},e),{hasExperimentBeenRecentlySaved:!0});case"SET_DRAFT_STATUS_RATIONALE":return E(E({},e),{draftStatusRationale:t.rationale});case"OPEN_ALTERNATIVE_PREVIEWER":return E(E({},e),{alternativePreviewerUrl:t.url});case"CLOSE_ALTERNATIVE_PREVIEWER":return E(E({},e),{alternativePreviewerUrl:""});case"SETUP_EDITOR":return e}}(e=E(E({},e),{hasExperimentBeenRecentlySaved:!1}),t))&&void 0!==n?n:e},experiment:(0,l.combineReducers)({alternatives:function(e,t){var n;return void 0===e&&(e=_),null!==(n=function(e,t){var n;switch(t.type){case"ADD_ALTERNATIVES":return{byId:h(h({},e.byId),(0,d.keyBy)(t.alternatives,"id")),allIds:y(y([],e.allIds,!0),(0,d.map)(t.alternatives,"id"),!0)};case"REMOVE_ALTERNATIVES":return{byId:h({control:e.byId.control},(0,d.omit)(e.byId,t.ids)),allIds:(0,d.difference)(e.allIds,t.ids.filter((function(e){return"control"!==e})))};case"REPLACE_ALTERNATIVES":var r=(0,d.zip)(t.oldIds,(0,d.map)(t.alternatives,"id"));return{byId:h(h({control:e.byId.control},(0,d.omit)(e.byId,t.oldIds)),(0,d.keyBy)(t.alternatives,"id")),allIds:y(y([],e.allIds.map((function(e){var t=r.find((function(t){return t[0]===e}));return t?t[1]:e})).filter(b.isDefined),!0),r.filter((function(e){return!e[0]})).map((function(e){return e[1]})).filter(b.isDefined),!0)};case"SET_ALTERNATIVE":return!t.alternative||(0,b.isEmpty)(t.alternative)||(0,b.isEmpty)(e.byId[t.id])?e:h(h({},e),{byId:h(h({},e.byId),(n={},n[t.id]=t.alternative,n))});case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?_:{byId:h({control:e.byId.control},(0,d.keyBy)(t.experiment.alternatives,"id")),allIds:(0,d.map)(t.experiment.alternatives,"id")}}}(e,t))&&void 0!==n?n:e},conversionActions:function(e,t){var n;return void 0===e&&(e=S),null!==(n=function(e,t){var n,r,i,a,o;switch(t.type){case"ADD_CONVERSION_ACTIONS_INTO_GOAL":return w(w({},e),((n={})[t.goalId]=w(w({},e[t.goalId]),(0,d.keyBy)(t.conversionActions,"id")),n));case"REPLACE_CONVERSION_ACTIONS_IN_GOAL":return w(w({},e),((r={})[t.goalId]=w({},(0,d.keyBy)(t.conversionActions,"id")),r));case"UPDATE_CONVERSION_ACTION":var s=e[t.goalId];if(!s)return e;var l=s[t.conversionActionId];return l?w(w({},e),((i={})[t.goalId]=w(w({},s),((a={})[t.conversionActionId]=w(w({},l),{attributes:t.attributes?w(w({},l.attributes),t.attributes):l.attributes,scope:t.scope?t.scope:l.scope}),a)),i)):e;case"REMOVE_CONVERSION_ACTIONS_FROM_GOAL":return w(w({},e),((o={})[t.goalId]=(0,d.omit)(e[t.goalId],t.conversionActionIds),o));case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:t.experiment.goals.reduce((function(e,t){return e[t.id]=(0,d.keyBy)(t.conversionActions,"id"),e}),{})}}(e,t))&&void 0!==n?n:e},data:function(e,t){var n;return void 0===e&&(e=N),null!==(n=function(e,t){switch(t.type){case"UPDATE_EXPERIMENT_DATA":return A(A({},e),t.attributes);case"SET_TESTED_ELEMENT_AS_INVALID":return A(A({},e),{isTestedElementInvalid:!!t.invalid});case"SETUP_EDITOR":return A(A({},e),(0,d.omit)(t.experiment,["alternatives","goals","scope","segments"]))}}(e,t))&&void 0!==n?n:e},goals:function(e,t){var n;return void 0===e&&(e=T),null!==(n=function(e,t){var n;switch(t.type){case"ADD_GOALS":return I(I({},e),(0,d.keyBy)(t.goals,"id"));case"UPDATE_GOAL":var r=e[t.goalId];return r?I(I({},e),((n={})[t.goalId]=I(I({},r),{attributes:I(I({},r.attributes),t.attributes)}),n)):e;case"REMOVE_GOALS":return(0,d.omit)(e,t.ids);case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:(0,d.keyBy)(t.experiment.goals.map((function(e){return(0,d.omit)(e,"conversionActions")})),"id")}}(e,t))&&void 0!==n?n:e},scope:function(e,t){var n;return void 0===e&&(e=R),null!==(n=function(e,t){switch(t.type){case"SET_SCOPE_RULES":return(0,d.keyBy)(t.rules,"id");case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:(0,d.keyBy)(t.experiment.scope,"id")}}(0,t))&&void 0!==n?n:e},segmentation:function(e,t){var n;return void 0===e&&(e=C),null!==(n=function(e,t){var n,r,i,a,o,s;switch(t.type){case"ADD_SEGMENTS":return O(O({},e),{segments:O(O({},e.segments),(0,d.keyBy)(t.segments,"id"))});case"UPDATE_SEGMENT":var l=e.segments[t.segmentId];return l?O(O({},e),{segments:O(O({},e.segments),(n={},n[t.segmentId]=O(O({},l),{attributes:O(O({},l.attributes),t.attributes)}),n))}):e;case"REMOVE_SEGMENTS":return O(O({},e),{segments:(0,d.omit)(e.segments,t.ids)});case"ADD_SEGMENTATION_RULES_INTO_SEGMENT":return O(O({},e),{rules:O(O({},e.rules),(r={},r[t.segmentId]=O(O({},e.rules[t.segmentId]),(0,d.keyBy)(t.segmentationRules,"id")),r))});case"REPLACE_SEGMENTATION_RULES_IN_SEGMENT":return O(O({},e),{rules:O(O({},e.rules),(i={},i[t.segmentId]=O({},(0,d.keyBy)(t.segmentationRules,"id")),i))});case"UPDATE_SEGMENTATION_RULE":var u=e.rules[t.segmentId];if(!u)return e;var c=u[t.segmentationRuleId];return c?O(O({},e),{rules:O(O({},e.rules),(a={},a[t.segmentId]=O(O({},u),(o={},o[t.segmentationRuleId]=O(O({},c),{attributes:O(O({},c.attributes),t.attributes)}),o)),a))}):e;case"REMOVE_SEGMENTATION_RULES_FROM_SEGMENT":return O(O({},e),{rules:O(O({},e.rules),(s={},s[t.segmentId]=(0,d.omit)(e.rules[t.segmentId],t.segmentationRuleIds),s))});case"SET_SEGMENT_EVALUATION":return O(O({},e),{evaluation:t.strategy});case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?e:{evaluation:t.experiment.segmentEvaluation,rules:t.experiment.segments.reduce((function(e,t){return e[t.id]=(0,d.keyBy)(t.segmentationRules,"id"),e}),{}),segments:(0,d.keyBy)(t.experiment.segments.map((function(e){return(0,d.omit)(e,"segmentationRules")})),"id")}}}(e,t))&&void 0!==n?n:e}})});var k={};function P(e){return[e]}function G(e,t,n){var r;if(e.length!==t.length)return!1;for(r=n;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function B(e,t){var n,r=t||P;function i(){n=new WeakMap}function a(){var t,i,a,o,s,l=arguments.length;for(o=new Array(l),a=0;a<l;a++)o[a]=arguments[a];for(t=function(e){var t,r,i,a,o,s=n,l=!0;for(t=0;t<e.length;t++){if(!(o=r=e[t])||"object"!=typeof o){l=!1;break}s.has(r)?s=s.get(r):(i=new WeakMap,s.set(r,i),s=i)}return s.has(k)||((a=function(){var e={clear:function(){e.head=null}};return e}()).isUniqueByDependants=l,s.set(k,a)),s.get(k)}(s=r.apply(null,o)),t.isUniqueByDependants||(t.lastDependants&&!G(s,t.lastDependants,0)&&t.clear(),t.lastDependants=s),i=t.head;i;){if(G(i.args,o,1))return i!==t.head&&(i.prev.next=i.next,i.next&&(i.next.prev=i.prev),i.next=t.head,i.prev=null,t.head.prev=i,t.head=i),i.val;i=i.next}return i={val:e.apply(null,o)},o[0]=null,i.args=o,t.head&&(t.head.prev=i,i.next=t.head),t.head=i,i.val}return a.getDependants=r,a.clear=i,i(),a}var M=function(e,t){return e.experiment.alternatives.byId[t]},L=B((function(e){return(0,d.values)(e.experiment.alternatives.byId).filter(b.isDefined)}),(function(e){return[e.experiment.alternatives.byId]})),V=function(e){return e.experiment.alternatives.allIds},U=B((function(e,t){return(0,d.values)(e.experiment.conversionActions[t])}),(function(e,t){return[e.experiment.conversionActions,t]}));function j(e){return!!e.editor.isExperimentBeingSaved}function q(e){return!!e.editor.hasExperimentBeenRecentlySaved}function F(e){return e.experiment.goals[e.editor.activeGoalId]||(0,d.values)(e.experiment.goals)[0]}function H(e){return(0,d.map)(e.experiment.goals,"id").indexOf(e.editor.activeGoalId)||0}function W(e){return(0,d.filter)(e.experiment.segmentation.segments,{id:e.editor.activeSegmentId})[0]}function Y(e){return(0,d.map)(e.experiment.segmentation.segments,"id").indexOf(e.editor.activeSegmentId)||0}function X(e){if(e.experiment&&e.experiment.data&&["draft","paused_draft"].includes(e.experiment.data.status))return e.editor.draftStatusRationale}function z(e){return e.editor.alternativePreviewerUrl}function J(e){return e.experiment.data.id}function Q(e){return e.experiment.data.type}var $=function(e,t){return e.experiment.data[t]},K=function(e,t){return e.experiment.data[t]};function Z(e){return!!e.experiment.data.isTestedElementInvalid}var ee=B((function(e){return(0,d.values)(e.experiment.goals).filter(b.isDefined)}),(function(e){return[e.experiment.goals]})),te=B((function(e){return(0,d.values)(e.experiment.scope).filter(b.isDefined)}),(function(e){return[e.experiment.scope]})),ne=B((function(e){return(0,d.values)(e.experiment.segmentation.segments).filter(b.isDefined)}),(function(e){return[e.experiment.segmentation.segments]})),re=B((function(e,t){return(0,d.values)(e.experiment.segmentation.rules[t])}),(function(e,t){return[e.experiment.segmentation.rules,t]}));function ie(e){return e.experiment.segmentation.evaluation}function ae(e){return{type:"ADD_ALTERNATIVES",alternatives:(0,d.castArray)(e)}}function oe(e){return{type:"REMOVE_ALTERNATIVES",ids:(0,d.castArray)(e)}}function se(e,t){return{type:"REPLACE_ALTERNATIVES",oldIds:(0,d.castArray)(e),alternatives:(0,d.castArray)(t)}}function le(e,t){return{type:"SET_ALTERNATIVE",id:e,alternative:t}}function ue(e,t){return{type:"ADD_CONVERSION_ACTIONS_INTO_GOAL",goalId:e,conversionActions:(0,d.castArray)(t)}}function ce(e,t){return{type:"REPLACE_CONVERSION_ACTIONS_IN_GOAL",goalId:e,conversionActions:(0,d.castArray)(t)}}function me(e,t){return{type:"REMOVE_CONVERSION_ACTIONS_FROM_GOAL",goalId:e,conversionActionIds:(0,d.castArray)(t)}}function de(e,t,n,r){return{type:"UPDATE_CONVERSION_ACTION",goalId:e,conversionActionId:t,attributes:n,scope:r}}function pe(e){return{type:"SETUP_EDITOR",experiment:e}}function ve(e){return{type:"SET_ACTIVE_GOAL",goalId:e}}function ge(e){return{type:"SET_ACTIVE_SEGMENT",segmentId:e}}function fe(e){return{type:"SET_EXPERIMENT_AS_BEING_SAVED",status:e}}function be(e){return{type:"SET_DRAFT_STATUS_RATIONALE",rationale:e}}function Ee(){return{type:"SET_EXPERIMENT_AS_RECENTLY_SAVED"}}function xe(e){return{type:"OPEN_ALTERNATIVE_PREVIEWER",url:e}}function he(){return{type:"CLOSE_ALTERNATIVE_PREVIEWER"}}function ye(e){return{type:"UPDATE_EXPERIMENT_DATA",attributes:e}}function _e(e){return{type:"UPDATE_EXPERIMENT_DATA",attributes:e}}function we(e){return{type:"SET_TESTED_ELEMENT_AS_INVALID",invalid:e}}function Se(e){return{type:"ADD_GOALS",goals:(0,d.castArray)(e)}}function Ae(e){return{type:"REMOVE_GOALS",ids:(0,d.castArray)(e)}}function Ne(e,t){return{type:"UPDATE_GOAL",goalId:e,attributes:t}}function Ie(e){return{type:"SET_SCOPE_RULES",rules:e}}function Te(e){return{type:"ADD_SEGMENTS",segments:(0,d.castArray)(e)}}function Re(e){return{type:"REMOVE_SEGMENTS",ids:(0,d.castArray)(e)}}function Oe(e,t){return{type:"UPDATE_SEGMENT",segmentId:e,attributes:t}}function Ce(e,t){return{type:"ADD_SEGMENTATION_RULES_INTO_SEGMENT",segmentId:e,segmentationRules:(0,d.castArray)(t)}}function De(e,t){return{type:"REPLACE_SEGMENTATION_RULES_IN_SEGMENT",segmentId:e,segmentationRules:(0,d.castArray)(t)}}function ke(e,t){return{type:"REMOVE_SEGMENTATION_RULES_FROM_SEGMENT",segmentId:e,segmentationRuleIds:(0,d.castArray)(t)}}function Pe(e,t,n){return{type:"UPDATE_SEGMENTATION_RULE",segmentId:e,segmentationRuleId:t,attributes:n}}function Ge(e){return{type:"SET_SEGMENT_EVALUATION",strategy:e}}const Be=window.wp.apiFetch;var Me=n.n(Be);const Le=window.wp.date,Ve=window.wp.url;var Ue=function(){return Ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ue.apply(this,arguments)};const je=function(e){var t=e.url,n=e.path,r=(0,Le.format)("YmjHi").substring(0,11)+"0";return Me()(Ue(Ue(Ue({},e),t&&{url:qe(e)?(0,Ve.addQueryArgs)(t,{nabts:r}):t}),n&&{path:(0,Ve.addQueryArgs)(n,{nabts:r})}))};var qe=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const Fe=window.wp.i18n,He=window.wp.notices,We=window.nab.experiments;var Ye=function(){return Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ye.apply(this,arguments)},Xe=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},ze=function(e,t){var n,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Je=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function Qe(){return Xe(this,void 0,Promise,(function(){var e,t,n,r,i,a,o,s,u,c,m,d,p,v,g,f,b,E,x,h,y,_,w,S,A,N,I,T,R,O,C;return ze(this,(function(D){switch(D.label){case 0:return(0,l.select)(lt).isExperimentBeingSaved()?[2]:[4,(0,l.dispatch)(lt).setExperimentAsBeingSaved(!0)];case 1:for(D.sent(),e=[],t=(0,l.select)(lt).getGoals(),n=0,r=t;n<r.length;n++)i=r[n],a=(0,l.select)(lt).getConversionActions(i.id),o=rt(a),e.push(Ye(Ye({},i),{attributes:Ye(Ye({},i.attributes),{useOrderRevenue:o?null===(N=i.attributes.useOrderRevenue)||void 0===N||N:void 0,orderStatusForConversion:o?it(o,i):void 0}),conversionActions:a}));for(s=[],u=(0,l.select)(lt).getSegments(),c=0,m=u;c<m.length;c++)d=m[c],s.push(Ye(Ye({},d),{segmentationRules:(0,l.select)(lt).getSegmentationRules(d.id)}));for(p=[],v=(0,l.select)(lt).getAlternativeIds(),g=(0,l.select)(lt).isTestedElementInvalid(),f=(0,l.select)(lt).getAlternative("control"),b=0,E=v;b<E.length;b++)"control"!==(x=E[b])&&(h=(0,l.select)(lt).getAlternative(x))&&p.push(h);_=(0,l.select)(lt).getExperimentType(),y="nab/heatmap"===_?{id:(0,l.select)(lt).getExperimentId(),type:_,name:(0,l.select)(lt).getExperimentAttribute("name"),description:(0,l.select)(lt).getExperimentAttribute("description"),status:(0,l.select)(lt).getExperimentAttribute("status"),startDate:(0,l.select)(lt).getExperimentAttribute("startDate"),endDate:!1,endMode:(0,l.select)(lt).getExperimentAttribute("endMode"),endValue:(0,l.select)(lt).getExperimentAttribute("endValue"),trackingMode:null!==(I=(0,l.select)(lt).getHeatmapAttribute("trackingMode"))&&void 0!==I?I:"post",trackedPostId:null!==(T=(0,l.select)(lt).getHeatmapAttribute("trackedPostId"))&&void 0!==T?T:0,trackedPostType:null!==(R=(0,l.select)(lt).getHeatmapAttribute("trackedPostType"))&&void 0!==R?R:"page",trackedUrl:null!==(O=(0,l.select)(lt).getHeatmapAttribute("trackedUrl"))&&void 0!==O?O:"",participationConditions:null!==(C=(0,l.select)(lt).getHeatmapAttribute("participationConditions"))&&void 0!==C?C:[]}:{id:(0,l.select)(lt).getExperimentId(),type:_,name:(0,l.select)(lt).getExperimentAttribute("name"),description:(0,l.select)(lt).getExperimentAttribute("description"),status:(0,l.select)(lt).getExperimentAttribute("status"),startDate:(0,l.select)(lt).getExperimentAttribute("startDate"),endDate:!1,endMode:(0,l.select)(lt).getExperimentAttribute("endMode"),endValue:(0,l.select)(lt).getExperimentAttribute("endValue"),autoAlternativeApplication:(0,l.select)(lt).getExperimentAttribute("autoAlternativeApplication"),scope:(0,l.select)(lt).getScope(),alternatives:g?[f]:Je([f],p,!0),goals:e,segmentEvaluation:(0,l.select)(lt).getSegmentEvaluation(),segments:s},D.label=2;case 2:return D.trys.push([2,7,,10]),[4,je({path:"/nab/v1/experiment/".concat(y.id),method:"PUT",data:y})];case 3:return w=D.sent(),"nab/heatmap"!==y.type&&g&&(w=Ye(Ye({},w),{alternatives:Je([w.alternatives[0]],p,!0)})),[4,(0,l.dispatch)(lt).setupEditor(w)];case 4:return D.sent(),[4,(0,l.dispatch)(lt).setExperimentAsBeingSaved(!1)];case 5:return D.sent(),[4,(0,l.dispatch)(lt).setExperimentAsRecentlySaved()];case 6:return D.sent(),[3,10];case 7:return S=D.sent(),A=at(S),[4,(0,l.dispatch)(He.store).createErrorNotice(A)];case 8:return D.sent(),[4,(0,l.dispatch)(lt).setExperimentAsBeingSaved(!1)];case 9:return D.sent(),[3,10];case 10:return[2]}}))}))}function $e(e){return Xe(this,void 0,Promise,(function(){var t;return ze(this,(function(n){switch(n.label){case 0:return[4,Qe()];case 1:return n.sent(),(0,l.select)(lt).hasExperimentBeenRecentlySaved()&&(0,l.select)(lt).getAlternativeIds().includes(e)&&(t=(0,l.select)(lt).getAlternative(e))&&t.links.edit?(window.location.href=t.links.edit,[2]):[2]}}))}))}function Ke(e){return Xe(this,void 0,Promise,(function(){var t,n,r,i;return ze(this,(function(a){switch(a.label){case 0:return[4,Qe()];case 1:return a.sent(),(0,l.select)(lt).hasExperimentBeenRecentlySaved()&&(0,l.select)(lt).getAlternativeIds().includes(e)?(null==(t=(0,l.select)(lt).getAlternative(e))?void 0:t.links.preview)?[3,3]:(n=(0,Fe._x)("Preview not available.","text","nelio-ab-testing"),r=(0,l.select)(lt).getExperimentType(),"urls"!==(i=(0,l.select)(We.store).getExperimentSupport(r,"scope"))&&"urls-with-tested-post"!==i||(n+=" ",n+=(0,Fe._x)("Please review your test scope and consider adding an exact URL where the test should be active so that Nelio can use it in the preview.","user","nelio-ab-testing")),[4,(0,l.dispatch)(He.store).createWarningNotice(n)]):[2];case 2:case 4:return a.sent(),[2];case 3:return[4,(0,l.dispatch)(lt).openAlternativePreviewer(t.links.preview)]}}))}))}function Ze(){return Xe(this,void 0,Promise,(function(){return ze(this,(function(e){switch(e.label){case 0:return[4,(0,l.dispatch)(lt).setExperimentData({status:"trash"})];case 1:return e.sent(),[4,Qe()];case 2:return e.sent(),window.location.href=(0,l.select)(v.store).getAdminUrl("edit.php",{post_type:"nab_experiment"}),[2]}}))}))}function et(){return Xe(this,void 0,Promise,(function(){return ze(this,(function(e){switch(e.label){case 0:return[4,nt("start")];case 1:return e.sent(),[2]}}))}))}function tt(){return Xe(this,void 0,Promise,(function(){return ze(this,(function(e){switch(e.label){case 0:return[4,nt("resume")];case 1:return e.sent(),[2]}}))}))}function nt(e){return Xe(this,arguments,Promise,(function(e,t){var n,r,i,a,o=this;return void 0===t&&(t=!1),ze(this,(function(s){switch(s.label){case 0:return[4,Qe()];case 1:return s.sent(),(0,l.select)(lt).hasExperimentBeenRecentlySaved()?[4,(0,l.dispatch)(lt).setExperimentAsBeingSaved(!0)]:[2];case 2:s.sent(),n=(0,l.select)(lt).getExperimentId(),s.label=3;case 3:return s.trys.push([3,5,,11]),[4,je({path:"/nab/v1/experiment/".concat(n,"/").concat(e),method:"PUT",data:{ignoreScopeOverlap:t}})];case 4:return s.sent(),[3,11];case 5:return r=s.sent(),i=at(r,"start"===e?(0,Fe._x)("Test can’t be started","text","nelio-ab-testing"):(0,Fe._x)("Test can’t be resumed","text","nelio-ab-testing")),"equivalent-experiment-running"!==function(e){if(!e||"object"!=typeof e)return!1;if(!("errors"in e)||"object"!=typeof e.errors)return!1;var t=e.errors||{};return Object.keys(t).includes("equivalent-experiment-running")&&"equivalent-experiment-running"}(r)?[3,7]:[4,(0,l.dispatch)(He.store).createWarningNotice(i,{actions:[{label:"start"===e?(0,Fe._x)("Start anyway","command","nelio-ab-testing"):(0,Fe._x)("Resume anyway","command","nelio-ab-testing"),variant:"primary",onClick:function(){return Xe(o,void 0,void 0,(function(){return ze(this,(function(t){switch(t.label){case 0:return[4,(0,l.dispatch)(He.store).removeNotice(a.id)];case 1:return t.sent(),[4,nt(e,!0)];case 2:return t.sent(),[2]}}))}))}}]})];case 6:return a=s.sent().notice,[3,9];case 7:return[4,(0,l.dispatch)(He.store).createErrorNotice(i)];case 8:s.sent(),s.label=9;case 9:return[4,(0,l.dispatch)(lt).setExperimentAsBeingSaved(!1)];case 10:return s.sent(),[2];case 11:return window.location.href=(0,l.select)(v.store).getAdminUrl("admin.php",{page:"nelio-ab-testing-experiment-view",experiment:n}),[2]}}))}))}function rt(e){if(e.length)return e.every((function(e){return"nab/wc-order"===e.type}))?"woocommerce":e.every((function(e){return"nab/edd-order"===e.type}))?"edd":void 0}function it(e,t){var n=(0,l.select)(v.store).getECommerceSetting(e,"orderStatuses"),r=t.attributes.orderStatusForConversion;return r&&n.map((function(e){return e.value})).includes(r)?r:function(e){switch(e){case"woocommerce":return"wc-completed";case"edd":return"complete"}}(e)}function at(e,t){var n=t||(0,Fe._x)("Unknown error","text","nelio-ab-testing");if(!e||"object"!=typeof e)return n;if("errors"in e&&"object"==typeof e.errors){var r=Array.isArray(e.errors)?e.errors:(0,d.values)(e.errors);if("string"==typeof r[0])return r[0]||n;var i=Array.isArray(r[0])&&"string"==typeof r[0][0]?r[0][0]:void 0;if(i)return i||n}return"message"in e&&"string"==typeof e.message&&e.message||n}var ot=function(){return ot=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ot.apply(this,arguments)},st=ot(ot({},i),a),lt=(0,l.createReduxStore)("nab/editor",{reducer:D,controls:l.controls,actions:st,selectors:r});!function(e){(0,l.register)(e)}(lt);var ut=function(e){var t=e.experiment,n=e.children,r=(0,s.useState)(!1),i=r[0],a=r[1],o=(0,l.useDispatch)(lt),u=o.setupEditor,c=o.setActiveGoal,m=o.setActiveSegment;return(0,s.useEffect)((function(){if(t){var e=t.goals[0]||(0,b.createGoal)(),n=t.segments[0];u(t),c(e.id),n&&m(n.id),a(!0)}}),[!!t]),i?s.createElement("div",null,n):null};const ct=window.wp.components,mt=window.nab.conversionActions,dt=window.nab.date,pt=window.nab.segmentationRules;function vt(e,t,n){var r;if(!e.conversionActions.length)return(0,Fe.sprintf)(/* translators: goal name */ /* translators: goal name */
(0,Fe._x)("%s doesn’t have any conversion actions","text","nelio-ab-testing"),gt(e,t));for(var i=0;i<e.conversionActions.length;++i){var a=e.conversionActions[i];if(a){var o=n[a.type];if(!o)return(0,Fe.sprintf)(/* translators: goal name */ /* translators: goal name */
(0,Fe._x)("%s has one or more invalid conversion actions","text","nelio-ab-testing"),gt(e,t));if(!(0,b.isEmpty)(null===(r=o.validate)||void 0===r?void 0:r.call(o,a.attributes))||!(0,b.isEmpty)((0,b.getConversionActionScopeError)(a.scope)))return(0,Fe.sprintf)(/* translators: goal name, as in “Goal 2” or “Default Goal” */ /* translators: goal name, as in “Goal 2” or “Default Goal” */
(0,Fe._x)("One or more conversion actions in %s are invalid","text","nelio-ab-testing"),gt(e,t))}}return!1}function gt(e,t){var n=(0,Fe.sprintf)(/* translators: goal id */ /* translators: goal id */
(0,Fe._x)("Goal %d","text","nelio-ab-testing"),t+1);return 0===t&&(n=(0,Fe._x)("Default Goal","text","nelio-ab-testing")),(0,d.trim)(e.attributes.name)&&(n=(0,Fe.sprintf)(/* translators: goal name */ /* translators: goal name */
(0,Fe._x)("Goal “%s”","text","nelio-ab-testing"),(0,d.trim)(e.attributes.name))),n}function ft(e,t,n){var r;if(!e.segmentationRules.length)return(0,Fe.sprintf)(/* translators: segment name */ /* translators: segment name */
(0,Fe._x)("%s doesn’t have any segmentation rules","text","nelio-ab-testing"),bt(e,t));for(var i=0;i<e.segmentationRules.length;++i){var a=e.segmentationRules[i];if(a){var o=n[a.type];if(!o)return(0,Fe.sprintf)(/* translators: segment name */ /* translators: segment name */
(0,Fe._x)("%s has one or more invalid segmentation rules","text","nelio-ab-testing"),bt(e,t));if(!(0,b.isEmpty)(null===(r=o.validate)||void 0===r?void 0:r.call(o,a.attributes)))return(0,Fe.sprintf)(/* translators: segment name, as in Segment 2” */ /* translators: segment name, as in Segment 2” */
(0,Fe._x)("One or more segmentation rules in %s are invalid","text","nelio-ab-testing"),bt(e,t))}}return!1}function bt(e,t){var n=(0,Fe.sprintf)(/* translators: segment id */ /* translators: segment id */
(0,Fe._x)("Segment %d","text","nelio-ab-testing"),t+1);return(0,d.trim)(e.attributes.name)&&(n=(0,Fe.sprintf)(/* translators: segment name */ /* translators: segment name */
(0,Fe._x)("Segment “%s”","text","nelio-ab-testing"),(0,d.trim)(e.attributes.name))),n}var Et=function(e){return"php-snippet"===(null==e?void 0:e.attributes.type)};function xt(e){var t=u((function(t){return t(lt).getExperimentAttribute(e)})),n=(0,l.useDispatch)(lt).setExperimentData;return[t,function(t){var r;n(((r={})[e]=t,r))}]}function ht(){var e=xt("type")[0];return u((function(t){return t(We.store).getExperimentType(e)}))}var yt=function(e){return u((function(t){return t(v.store).isSubscribedTo(e)}))},_t=function(){var e=St(),t=Math.min(8,(0,v.usePluginSetting)("maxCombinations")),n=u((function(e){return e(lt).getAlternativeIds().length}));return!wt()&&!!e&&n<t},wt=function(){return xt("status")[0].includes("paused")},St=function(){return u((function(e){return e(v.store).getPluginSetting("subscription")}))},At=function(){return At=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},At.apply(this,arguments)},Nt=function(){return It(),Tt(),null},It=function(){var e=Rt(),t=xt("startDate")[0]||"",n=xt("status"),r=n[0],i=n[1],a=(0,l.useDispatch)(lt).setDraftStatusRationale,o=function(e,t){r.includes("paused")&&(e="draft"===e?"paused_draft":"paused"),i(e),a(null!=t?t:"")};(0,s.useEffect)((function(){"running"!==r&&"trash"!==r&&(e?o("draft",e):"ready"!==r&&("scheduled"!==r||(0,dt.isInTheFuture)(t)||o("ready"),"scheduled"!==r&&o("ready")))}),[e,t,r])},Tt=function(){var e=xt("status")[0],t=Ot(),n=ht(),r=(0,d.find)(t,{id:"control"}),i=u((function(e){return e(lt).isTestedElementInvalid()})),a=(0,l.useDispatch)(lt).setTestedElementAsInvalid;(0,s.useEffect)((function(){if("running"!==e){var t=!!r&&!!n&&!!n.checks.getControlError(r.attributes,l.select);(0,d.isEqual)(i,t)||a(t)}}),[r,l.select,n,i])},Rt=function(){var e=(0,s.useState)(""),t=e[0],n=e[1],r=xt("name")[0]||"",i=ht(),a=Ot(),o=Ct(),u=Dt(),c=kt(),m=Pt(),p=Gt();return(0,s.useEffect)((function(){if(i){var e=(0,d.find)(a,{id:"control"}),t=function(e,t,n){var r=e.control,i=e.alternatives,a=e.goals,o=e.scope,s=e.segments,u=e.name,c=e.type;if(!u)return(0,Fe._x)("Test is unnamed","text","nelio-ab-testing");if(i.length<2)return(0,Fe._x)("Test doesn’t have any variants","text","nelio-ab-testing");var m=c.checks.getControlError(r.attributes,l.select);if(m)return m;i[0];var p=i.slice(1).reduce((function(e,t,n){return e||c.checks.getAlternativeError(t.attributes,(0,b.getLetter)(n+1),r.attributes,l.select)}),!1);if(p)return p;var v=function(e){var t,n=e[0];if(Et(n))return!!n.attributes.value.errorMessage&&(0,Fe._x)("Test scope is incorrect","text","nelio-ab-testing");for(var r=0,i=e.filter((function(e){return"tested-url-with-query-args"===e.attributes.type}));r<i.length;r++){var a=i[r],o=null===(t=(0,d.toPairs)((0,d.countBy)(a.attributes.value.args,"name")).find((function(e){var t=e[0],n=e[1];return!!t&&n>=2})))||void 0===t?void 0:t[0];if(o)return(0,Fe.sprintf)(/* translators: query parameter’s name */ /* translators: query parameter’s name */
(0,Fe._x)("Query parameter “%s” should only appear once in the test scope","text","nelio-ab-testing"),o)}return!1}(o);if(v)return v;var g=function(e,t){if(!e.length)return(0,Fe._x)("Test doesn’t have any goals","text","nelio-ab-testing");for(var n=0;n<e.length;++n){var r=e[n];if(r){var i=vt(r,n,t);if(i)return i}}return!1}(a,t);if(g)return g;var f=function(e,t){for(var n=0;n<e.length;++n){var r=e[n];if(r){var i=ft(r,n,t);if(i)return i}}return!1}(s,n);return f||!1}({name:r,control:e,alternatives:a,scope:c,goals:o,segments:u,type:i},m,p);n(t||"")}else n((0,Fe._x)("Type not found","text","nelio-ab-testing"))}),[r,i,JSON.stringify(a),JSON.stringify(o),JSON.stringify(u),c]),t},Ot=function(){return u((function(e){return e(lt).getAlternatives()}))},Ct=function(){return u((function(e){var t=e(lt),n=t.getGoals,r=t.getConversionActions;return(0,d.map)(n(),(function(e){return At(At({},e),{conversionActions:r(e.id)})}))}))},Dt=function(){return u((function(e){var t=e(lt),n=t.getSegments,r=t.getSegmentationRules;return(0,d.map)(n(),(function(e){return At(At({},e),{segmentationRules:r(e.id)})}))}))},kt=function(){return u((function(e){return e(lt).getScope()}))},Pt=function(){return u((function(e){return(0,d.keyBy)(e(mt.store).getConversionActionTypes()||[],"name")}))},Gt=function(){return u((function(e){return(0,d.keyBy)(e(pt.store).getSegmentationRuleTypes()||[],"name")}))};const Bt=window.nab.components;var Mt=function(){var e=(0,s.useRef)(null),t=Ut(),n=Vt(),r=jt(),i=xt("status")[0],a=(i||"").includes("draft"),o=(i||"").includes("paused"),u=qt(),c=Ft(),m=Ht(),d=(0,l.useDispatch)(lt),p=d.saveExperiment,v=d.setExperimentData,g=Lt();return s.createElement("div",{ref:e,className:"nab-edit-experiment-header"},s.createElement("div",{className:"nab-edit-experiment-header__info"},t&&s.createElement(t,{className:"nab-edit-experiment-header__experiment-icon"}),s.createElement("h1",{className:"nab-edit-experiment-header__title"},(0,Fe._x)("Edit Test","text","nelio-ab-testing")),s.createElement(Bt.SubscribeWithCouponButton,{className:"finished"===i?"nab-edit-experiment-header__right-promo-button":void 0})),s.createElement("div",{className:"nab-edit-experiment-header__settings"},u&&s.createElement("span",{className:"nab-edit-experiment-header__save-button nab-edit-experiment-header__save-button--is-saving"},s.createElement(ct.Dashicon,{icon:"cloud"}),(0,Fe._x)("Saving…","text","nelio-ab-testing")),c&&"scheduled"!==i&&s.createElement("span",{className:"nab-edit-experiment-header__save-button nab-edit-experiment-header__save-button--has-been-saved"},s.createElement(ct.Dashicon,{icon:"yes"}),(0,Fe._x)("Saved","text (experiment)","nelio-ab-testing")),!u&&!(c&&"scheduled"!==i)&&s.createElement(ct.Button,{variant:"tertiary",className:"nab-edit-experiment-header__save-button",onClick:"scheduled"===i?function(){v({status:o?"paused":"ready"}),p()}:p},"scheduled"===i?(0,Fe._x)("Save as Ready","command (experiment)","nelio-ab-testing"):(0,Fe._x)("Save","command","nelio-ab-testing")),s.createElement("div",{className:"nab-edit-experiment-header__start-button"},s.createElement(Bt.Tooltip,{text:r,placement:"left",getTooltipContainer:e.current?function(){return e.current}:void 0},s.createElement("span",null,s.createElement(ct.Button,{variant:"primary",disabled:a||u||!g||c&&"scheduled"===i,onClick:m},n))))))},Lt=function(){var e=(xt("status")[0]||"").includes("paused");return u((function(t){return(0,t(v.store).hasCapability)(e?"resume_nab_experiments":"start_nab_experiments")}))},Vt=function(){var e=xt("startDate")[0],t=xt("status")[0];return(t||"").includes("paused")?(0,Fe._x)("Resume…","command","nelio-ab-testing"):e&&(0,dt.isInTheFuture)(e)?"scheduled"===t?(0,Fe._x)("Schedule","command","nelio-ab-testing"):(0,Fe._x)("Schedule…","command","nelio-ab-testing"):(0,Fe._x)("Start…","command","nelio-ab-testing")},Ut=function(){return u((function(e){var t,n=e(We.store).getExperimentTypes,r=e(lt).getExperimentType;return null===(t=n()[r()])||void 0===t?void 0:t.icon}))},jt=function(){return u((function(e){return e(lt).getDraftStatusRationale()}))},qt=function(){return u((function(e){return e(lt).isExperimentBeingSaved()}))},Ft=function(){return u((function(e){return e(lt).hasExperimentBeenRecentlySaved()}))},Ht=function(){var e=xt("status")[0],t=xt("startDate")[0],n=(e||"").includes("paused"),r=(0,l.useDispatch)(lt),i=r.resumeExperiment,a=r.setExperimentData,o=r.saveExperiment,s=r.startExperiment;return function(){n?i():t&&(0,dt.isInTheFuture)(t)?(a({status:"scheduled"}),o()):s()}};const Wt=window.wp.blockEditor;var Yt=function(){var e=xt("name"),t=e[0],n=e[1];return s.createElement("div",{className:"nab-experiment-title"},s.createElement(Wt.PlainText,{value:t,className:"nab-experiment-title__edit",placeholder:(0,Fe._x)("Name your test…","user","nelio-ab-testing"),onChange:n}))},Xt=function(){return Xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xt.apply(this,arguments)},zt=function(e){var t,n=e.readOnly,r=e.action,i=e.goalId,a=Jt(),o=Qt(),l=$t(),u=Kt(r.type),c=null==u?void 0:u.view,m=null==u?void 0:u.edit,d=null==u?void 0:u.icon,p=(null==r?void 0:r.attributes)||{},v=(null==r?void 0:r.scope)||{type:"test-scope"},g=null!==(t=null==u?void 0:u.validate)&&void 0!==t?t:function(){return{}},f=Xt(Xt({},g(p)),{_scope:(0,b.getConversionActionScopeError)(v)}),E=(0,s.useState)(!(0,b.isEmpty)(f))[0],x=Zt(i,r.id),h=x.setAttributes,y=x.setScope,_=en(i,r.id);return o?n?s.createElement("div",{className:"nab-conversion-action"},s.createElement("div",{className:"nab-conversion-action__view"},d?s.createElement(d,{className:"nab-conversion-action__icon"}):s.createElement(ct.Dashicon,{className:"nab-conversion-action__icon nab-conversion-action__icon--invalid",icon:"warning"}),s.createElement("div",{className:"nab-conversion-action__actual-view"},c?s.createElement(c,{attributes:p,scope:v,experimentId:a,goal:o.attributes,goalId:i,goalIndex:l}):s.createElement("span",null,(0,Fe._x)("Invalid conversion action.","text","nelio-ab-testing"))))):s.createElement(ct.PanelBody,{className:"nab-conversion-action",initialOpen:E,title:s.createElement("div",{className:"nab-conversion-action__view"},d?s.createElement(d,{className:"nab-conversion-action__icon"}):s.createElement(ct.Dashicon,{className:"nab-conversion-action__icon nab-conversion-action__icon--invalid",icon:"warning"}),s.createElement("div",{className:"nab-conversion-action__actual-view"},c?s.createElement(c,{attributes:p,scope:v,experimentId:a,goal:o.attributes,goalId:i,goalIndex:l}):s.createElement("span",null,(0,Fe._x)("Invalid conversion action.","text","nelio-ab-testing"))))},s.createElement("div",{className:"nab-conversion-action__edit"},m?s.createElement(m,{attributes:p,scope:v,experimentId:a,goal:o.attributes,goalId:i,goalIndex:l,setAttributes:h,setScope:y,errors:f}):s.createElement("span",null,(0,Fe._x)("This conversion action can’t be properly loaded. Please consider removing it.","text","nelio-ab-testing"))),s.createElement(ct.Button,{variant:"link",isDestructive:!0,onClick:_,className:"nab-conversion-action__delete-button"},(0,Fe._x)("Delete","command","neli-ab-testing"))):null},Jt=function(){return u((function(e){return e(lt).getExperimentId()}))},Qt=function(){return u((function(e){return e(lt).getActiveGoal()}))},$t=function(){return u((function(e){return e(lt).getActiveGoalIndex()}))},Kt=function(e){return u((function(t){return t(mt.store).getConversionActionType(e)}))},Zt=function(e,t){var n=(0,l.useDispatch)(lt).updateConversionAction,r=function(r,i){return n(e,t,r,i)},i=(0,s.useCallback)((function(e){return r(e,void 0)}),[e,t]),a=(0,s.useCallback)((function(e){return r(void 0,e)}),[e,t]);return{setAttributes:e&&t?i:d.noop,setScope:e&&t?a:d.noop}},en=function(e,t){var n=(0,l.useDispatch)(lt).removeConversionActionsFromGoal;return e&&t?function(){return n(e,t)}:d.noop},tn=function(){var e=nn(),t=rn(e);return s.createElement("div",{className:"nab-conversion-action-list nab-conversion-action-list--automatic"},1===t.length?s.createElement("p",{key:"conversion-action-explanation",className:"nab-conversion-action-list__help"},(0,Fe._x)("By default, there will be a new conversion in this test when the following conversion action occurs after the visitor has seen the tested element:","text","nelio-ab-testing")):s.createElement("p",{key:"conversion-action-explanation",className:"nab-conversion-action-list__help"},(0,Fe._x)("Split tests are usually run with some specific goals in mind. In this type of test, there’s a new conversion when at least one of the following conversion actions occurs after the visitor has seen the tested element:","text","nelio-ab-testing")),e&&t.map((function(t){return s.createElement(zt,{key:t.id,goalId:e,action:t,readOnly:!0})})))},nn=function(){return u((function(e){var t;return null===(t=e(lt).getActiveGoal())||void 0===t?void 0:t.id}))},rn=function(e){return u((function(t){return e&&(0,t(lt).getConversionActions)(e)||[]}))},an=function(){var e=on(),t=sn(e);return s.createElement("div",{className:"nab-conversion-action-list"},!!t.length&&s.createElement("p",{key:"conversion-action-explanation-1"},(0,Fe._x)("After a visitor has seen the tested element, there’s a new conversion every time one of the following conversion actions occurs:","text","nelio-ab-testing")),e&&t.map((function(t){return s.createElement(zt,{key:t.id,goalId:e,action:t})})),!t.length&&[s.createElement("p",{key:"conversion-action-explanation-1",className:"nab-conversion-action-list__help"},(0,Fe._x)("Split tests are usually run with some specific goals in mind, such as “getting more subscribers” or “showing interest in your products.” Goals are fulfilled when the visitor performs certain actions. For instance, a visitor might be “showing interest in your products” when they visit your pricing page or they submit a certain form in your website.","text","nelio-ab-testing")),s.createElement("p",{key:"conversion-action-explanation-2",className:"nab-conversion-action-list__help"},(0,s.createInterpolateElement)((0,Fe._x)("Use the buttons below to <strong>add the specific conversion actions</strong> that fulfill this goal.","user","nelio-ab-testing"),{strong:s.createElement("strong",null)}))])},on=function(){return u((function(e){var t;return null===(t=e(lt).getActiveGoal())||void 0===t?void 0:t.id}))},sn=function(e){return u((function(t){return e&&(0,t(lt).getConversionActions)(e)||[]}))},ln=function(){var e=!!(0,v.usePluginSetting)("subscription"),t=un(),n=!!mn(t).length,r=cn(),i=(0,l.useDispatch)(lt).addConversionActionsIntoGoal;return!e&&n?s.createElement("div",{className:"nab-conversion-action-type-list"},s.createElement(ct.ExternalLink,{className:"components-button is-secondary",href:(0,b.addFreeTracker)((0,Fe._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,Fe._x)("Subscribe to Track More Actions","user","nelio-ab-testing"))):s.createElement("ul",{className:"nab-conversion-action-type-list"},r&&r.map((function(e){var n=e.icon;return s.createElement(ct.Tooltip,{key:e.name,text:e.title,placement:"top"},s.createElement("li",{key:e.name,className:"nab-conversion-action-type-list__item"},s.createElement(ct.Button,{variant:"secondary",className:"nab-conversion-action-type-list__new-action-button",onClick:function(){return function(e){if(t){var n=(0,mt.createConversionAction)(e);n&&i(t,n)}}(e.name)}},s.createElement(n,null))))})))},un=function(){return u((function(e){var t;return null===(t=e(lt).getActiveGoal())||void 0===t?void 0:t.id}))},cn=function(){var e=un(),t=mn(e);return u((function(e){var n=e(mt.store).getConversionActionTypes,r=(0,d.filter)(n(),(function(t){return!t.isActive||t.isActive(e)}));if(!t.length)return r;for(var i=(0,d.filter)(r,(function(e){return!!e.requiresUniformity})),a=function(e){if((0,d.every)(t,(function(t){return t.type===e.name})))return{value:[e]}},o=0,s=i;o<s.length;o++){var l=a(s[o]);if("object"==typeof l)return l.value}return i.length?(0,d.difference)(r,i):r}))},mn=function(e){return u((function(t){return e&&t(lt).getConversionActions(e)||[]}))},dn=function(){var e=gn();return e?s.createElement(pn,{plugin:e}):null},pn=function(e){var t=e.plugin,n=vn(t),r=fn(),i=r[0],a=r[1],o=En(t),l=bn(t),u=l[0],c=l[1];return s.createElement("div",{className:"nab-ecommerce-goal-settings"},s.createElement("p",null,s.createElement("strong",null,n)),s.createElement(ct.SelectControl,{label:(0,Fe._x)("Order status required for conversions:","command","nelio-ab-testing"),options:o,value:u,onChange:c}),s.createElement(ct.CheckboxControl,{label:(0,Fe._x)("Track revenue and show in test results","command","nelio-ab-testing"),checked:i,onChange:a}))},vn=function(e){switch(e){case"woocommerce":return(0,Fe._x)("WooCommerce Goal Settings","text","nelio-ab-testing");case"edd":return(0,Fe._x)("Easy Digital Downloads Goal Settings","text","nelio-ab-testing")}},gn=function(){return u((function(e){var t,n=e(lt).getActiveGoal,r=e(lt).getConversionActions,i=null===(t=n())||void 0===t?void 0:t.id,a=i?r(i):[];if(a.length)return a.every((function(e){return"nab/wc-order"===e.type}))?"woocommerce":a.every((function(e){return"nab/edd-order"===e.type}))?"edd":void 0}))},fn=function(){var e,t=xn(),n=null===(e=null==t?void 0:t.attributes.useOrderRevenue)||void 0===e||e,r=(0,l.useDispatch)(lt).updateGoal;return[n,function(){return t?r(t.id,{useOrderRevenue:!n}):void 0}]},bn=function(e){var t=xn(),n=En(e),r=null==t?void 0:t.attributes.orderStatusForConversion,i=r&&n.map((function(e){return e.value})).includes(null==t?void 0:t.attributes.orderStatusForConversion)?r:hn(e),a=(0,l.useDispatch)(lt).updateGoal;return[i,function(e){return t?a(t.id,{orderStatusForConversion:e}):void 0}]},En=function(e){return u((function(t){return t(v.store).getECommerceSetting(e,"orderStatuses")}))},xn=function(){return u((function(e){return e(lt).getActiveGoal()}))},hn=function(e){switch(e){case"woocommerce":return"wc-completed";case"edd":return"complete"}},yn=function(e){var t=e.name,n=e.setName,r=e.removeGoal,i=e.isAutomatic;return s.createElement("div",{className:"nab-current-goal-info"},!i&&s.createElement("div",{className:"nab-current-goal-info__header"},s.createElement(ct.TextControl,{placeholder:(0,Fe._x)("Name your goal…","user","nelio-ab-testing"),value:t,onChange:function(e){return n(e)}}),!!r&&s.createElement(ct.Button,{variant:"tertiary",isDestructive:!0,className:"nab-current-goal-info__delete-button",onClick:r},(0,Fe._x)("Delete","command (goal)","nelio-ab-testing"))),s.createElement(dn,null),i?s.createElement(tn,null):s.createElement(s.Fragment,null,s.createElement(an,null),s.createElement(ln,null)))},wn=n(6942),Sn=n.n(wn),An=function(){var e=Nn(),t=In(),n=Tn(),r=!!(0,v.usePluginSetting)("subscription"),i=(0,l.useDispatch)(lt),a=i.setActiveGoal,o=i.addGoals;return s.createElement("ul",{className:"nab-goal-list"},t.map((function(t,n){return s.createElement("li",{key:t.id,className:Sn()("nab-goal-list__item",{"nab-goal-list__item--is-active":t.id===e})},s.createElement(ct.Button,{disabled:t.id===e,onClick:function(){return a(t.id)}},(0,d.trim)(t.attributes.name)||function(e){return e?(0,Fe.sprintf)(/* translators: a number */ /* translators: a number */
(0,Fe._x)("Goal %d","text","nelio-ab-testing"),e+1):(0,Fe._x)("Default Goal","text","nelio-ab-testing")}(n)))})),!n&&r&&s.createElement("li",{className:"nab-goal-list__add-new-goal",key:"add-new-goal"},s.createElement(ct.Button,{className:"nab-goal-list__add-new-goal-button",variant:"link",onClick:function(){var e=(0,b.createGoal)();o(e),a(e.id)}},s.createElement(ct.Dashicon,{icon:"plus"}),s.createElement("span",null,(0,Fe._x)("New","command (goal)","nelio-ab-testing")))))},Nn=function(){return u((function(e){var t;return null===(t=e(lt).getActiveGoal())||void 0===t?void 0:t.id}))},In=function(){return u((function(e){return e(lt).getGoals()}))},Tn=function(){return(xt("status")[0]||"").includes("paused")},Rn=function(){return Rn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Rn.apply(this,arguments)},On=function(){var e;Gn();var t=Cn(),n=Dn(),r=kn(),i=n.length,a=Pn(),o=(0,l.useDispatch)(lt),u=o.removeGoals,c=o.setActiveGoal,m=o.updateGoal,p=1<i&&!r;return s.createElement("div",{className:"nab-edit-experiment__goal-section"},s.createElement("h2",null,(0,s.createInterpolateElement)((0,Fe.sprintf)(/* translators: dashicon */ /* translators: dashicon */
(0,Fe._x)("%s Conversion Goals and Actions","text","nelio-ab-testing"),"<icon></icon>"),{icon:s.createElement(ct.Dashicon,{className:"nab-goal-section__title-icon",icon:"flag"})})),s.createElement("div",{className:"nab-edit-experiment-goal-section__content"},s.createElement(An,null),s.createElement(yn,{name:null!==(e=null==t?void 0:t.attributes.name)&&void 0!==e?e:"",setName:function(e){return n={name:e},t&&m(t.id,Rn(Rn({},t.attributes),n));var n},removeGoal:p?function(){if(t){var e=function(e,t){var n=(0,d.findIndex)(e,{id:t});return n===e.length-1?e[n-1]:e[n+1]}(n,t.id);e&&(c(e.id),u(t.id))}}:void 0,isAutomatic:a})))},Cn=function(){return u((function(e){return e(lt).getActiveGoal()}))},Dn=function(){return u((function(e){return e(lt).getGoals()}))},kn=function(){return(xt("status")[0]||"").includes("paused")},Pn=function(){var e=Cn(),t=Dn();return u((function(n){var r,i=n(lt).getExperimentType,a=n(We.store).hasExperimentSupport;return(null==e?void 0:e.id)===(null===(r=t[0])||void 0===r?void 0:r.id)&&a(i(),"automaticGoalSetup")}))},Gn=function(){var e,t=(0,l.useDispatch)(lt).replaceConversionActionsInGoal,n=null===(e=Dn()[0])||void 0===e?void 0:e.id,r=u((function(e){return e(lt).getAlternative("control")})),i=u((function(e){var t=e(lt).getExperimentType;return(0,e(We.store).getExperimentSupport)(t(),"automaticGoalSetup")})),a=u((function(e){return e(lt),n?e(lt).getConversionActions(n):[]}));(0,s.useEffect)((function(){if(r&&n&&i){var e=i(r.attributes);(0,d.isEqual)(Bn(a),Bn(e))||t(n,e)}}),[i,n,r])},Bn=function(e){return e.map((function(e){return(0,d.omit)(e,"id")}))},Mn=function(e){var t,n=e.readOnly,r=e.rule,i=e.setAttributes,a=e.remove,o=Ln(),l=Vn(r.type),u=null==l?void 0:l.view,c=null==l?void 0:l.edit,m=null==l?void 0:l.icon,d=(null==r?void 0:r.attributes)||{},p=(null!==(t=null==l?void 0:l.validate)&&void 0!==t?t:function(){return{}})(d),v=(0,s.useState)(!(0,b.isEmpty)(p))[0];return n?s.createElement("div",{className:"nab-segmentation-rule"},s.createElement("div",{className:"nab-segmentation-rule__view"},m?s.createElement(m,{className:"nab-segmentation-rule__icon"}):s.createElement(ct.Dashicon,{className:"nab-segmentation-rule__icon nab-segmentation-rule__icon--invalid",icon:"warning"}),s.createElement("div",{className:"nab-segmentation-rule__actual-view"},u?s.createElement(u,{attributes:d,experimentId:o}):s.createElement("span",null,(0,Fe._x)("Invalid segmentation rule.","text","nelio-ab-testing"))))):s.createElement(ct.PanelBody,{className:"nab-segmentation-rule",initialOpen:v,title:s.createElement("div",{className:"nab-segmentation-rule__view"},m?s.createElement(m,{className:"nab-segmentation-rule__icon"}):s.createElement(ct.Dashicon,{className:"nab-segmentation-rule__icon nab-segmentation-rule__icon--invalid",icon:"warning"}),s.createElement("div",{className:"nab-segmentation-rule__actual-view"},u?s.createElement(u,{attributes:d,experimentId:o}):s.createElement("span",null,(0,Fe._x)("Invalid segmentation rule.","text","nelio-ab-testing"))))},s.createElement("div",{className:"nab-segmentation-rule__edit"},c?s.createElement(c,{attributes:d,experimentId:o,setAttributes:i,errors:p}):s.createElement("span",null,(0,Fe._x)("This segmentation rule can’t be properly loaded. Please consider removing it.","text","nelio-ab-testing"))),s.createElement(ct.Button,{variant:"link",isDestructive:!0,onClick:a,className:"nab-segmentation-rule__delete-button"},(0,Fe._x)("Delete","command","neli-ab-testing")))},Ln=function(){return u((function(e){return e(lt).getExperimentId()}))},Vn=function(e){return u((function(t){return t(pt.store).getSegmentationRuleType(e)}))},Un=function(){var e=qn(),t=Fn(),n=Hn();return s.createElement("div",{className:"nab-segmentation-rule-list"},!!e.length&&s.createElement("p",{key:"segmentation-rule-explanation-1"},(0,Fe._x)("A visitor participates in the test every time all of the following segmentation rules match:","text","nelio-ab-testing")),e.map((function(e){return s.createElement(Mn,{key:e.id,rule:e,setAttributes:function(n){return t(e.id,n)},remove:function(){return n(e.id)}})})),!e.length&&[s.createElement("p",{key:"segmentation-rule-explanation-1",className:"nab-segmentation-rule-list__help"},(0,Fe._x)("Split tests are usually applied to all visitors. But you can narrow your audience using segmentation rules to target only a subset of your visitors.","text","nelio-ab-testing")),s.createElement("p",{key:"segmentation-rule-explanation-2",className:"nab-segmentation-rule-list__help"},(0,s.createInterpolateElement)((0,Fe._x)("Use the buttons below to <strong>add the specific segmentation rules</strong> for this segment.","user","nelio-ab-testing"),{strong:s.createElement("strong",null)}))])},jn=function(){return u((function(e){return e(lt).getActiveSegment()}))},qn=function(){var e=jn();return u((function(t){var n=t(lt).getSegmentationRules;return(null==e?void 0:e.id)&&n(e.id)||[]}))},Fn=function(){var e,t=null===(e=jn())||void 0===e?void 0:e.id,n=(0,l.useDispatch)(lt).updateSegmentationRule;return function(e,r){return t?n(t,e,r):Wn}},Hn=function(){var e,t=null===(e=jn())||void 0===e?void 0:e.id,n=(0,l.useDispatch)(lt).removeSegmentationRulesFromSegment;return function(e){return t?n(t,e):Wn}},Wn=function(){},Yn=function(e){var t=e.category,n=e.createSegmentationRule,r=e.segmentationRules,i=Xn(t.name),a=t.icon;return i.length?s.createElement("li",{key:t.name,className:"nab-segmentation-rule-type-category"},s.createElement(ct.DropdownMenu,{icon:s.createElement(a,null),className:"nab-segmentation-rule-type-category__item",label:t.title,controls:i.map((function(e){var t=e.name,i=e.title,a=e.icon,o=e.singleton;return{title:i,icon:s.createElement(a,null),isDisabled:o&&r.some((function(e){return e.type===t})),onClick:function(){return n(t)}}})),toggleProps:{className:"nab-segmentation-rule-type-category__toggle",disabled:i.every((function(e){var t=e.name;return e.singleton&&r.some((function(e){return e.type===t}))}))},menuProps:{className:"nab-segmentation-rule-type-category__menu"}})):null},Xn=function(e){return u((function(t){return(t(pt.store).getSegmentationRuleTypes()||[]).filter((function(t){return t.category===e}))}))},zn=function(e){var t=e.createSegmentationRule,n=e.segmentationRules,r=Jn();return(0,v.usePluginSetting)("subscription")?s.createElement("ul",{className:"nab-segmentation-rule-type-category-list"},r.map((function(e){return s.createElement(Yn,{key:e.name,category:e,createSegmentationRule:t,segmentationRules:n})}))):s.createElement("div",{className:"nab-segmentation-rule-type-list"},s.createElement(ct.ExternalLink,{className:"components-button is-secondary",href:(0,b.addFreeTracker)((0,Fe._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,Fe._x)("Subscribe to Use Segmentation Rules","user","nelio-ab-testing")))},Jn=function(){return u((function(e){return e(pt.store).getSegmentationRuleTypeCategories()||[]}))},Qn=function(e){var t=e.name,n=e.setName,r=e.removeSegment,i=Kn(),a=Zn();return s.createElement("div",{className:"nab-current-segment-info"},s.createElement("div",{className:"nab-current-segment-info__header"},s.createElement(ct.TextControl,{placeholder:(0,Fe._x)("Name your segment…","user","nelio-ab-testing"),value:t,onChange:function(e){return n(e)}}),!!r&&s.createElement(ct.Button,{variant:"tertiary",isDestructive:!0,className:"nab-current-segment-info__delete-button",onClick:r},(0,Fe._x)("Delete","command (segment)","nelio-ab-testing"))),s.createElement(Un,null),s.createElement(zn,{segmentationRules:i,createSegmentationRule:a}))},$n=function(){return u((function(e){return e(lt).getActiveSegment()}))},Kn=function(){var e=$n();return u((function(t){var n=t(lt).getSegmentationRules;return(null==e?void 0:e.id)&&n(e.id)||[]}))},Zn=function(){var e=(0,l.useDispatch)(lt).addSegmentationRulesIntoSegment,t=$n();return function(n){if(t){var r=(0,pt.createSegmentationRule)(n);r&&e(t.id,r)}}},er=function(){var e=tr(),t=nr(),n=rr(),r=!!(0,v.usePluginSetting)("subscription"),i=(0,l.useDispatch)(lt),a=i.setActiveSegment,o=i.addSegments;return s.createElement("ul",{className:"nab-segment-list"},t.map((function(t,n){return s.createElement("li",{key:t.id,className:Sn()("nab-segment-list__item",{"nab-segment-list__item--is-active":t.id===e})},s.createElement(ct.Button,{disabled:t.id===e,onClick:function(){return a(t.id)}},(0,d.trim)(t.attributes.name)||ir(n)))})),!n&&r&&s.createElement("li",{className:"nab-segment-list__add-new-segment",key:"add-new-segment"},s.createElement(ct.Button,{className:"nab-segment-list__add-new-segment-button",variant:"link",onClick:function(){var e=(0,b.createSegment)();o(e),a(e.id)}},s.createElement(ct.Dashicon,{icon:"plus"}),s.createElement("span",null,(0,Fe._x)("New","command (segment)","nelio-ab-testing")))))},tr=function(){return u((function(e){var t;return null===(t=e(lt).getActiveSegment())||void 0===t?void 0:t.id}))},nr=function(){return u((function(e){return e(lt).getSegments()||[]}))},rr=function(){return xt("status")[0].includes("paused")},ir=function(e){return(0,Fe.sprintf)(/* translators: a number */ /* translators: a number */
(0,Fe._x)("Segment %d","text","nelio-ab-testing"),e+1)},ar=function(){return ar=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ar.apply(this,arguments)},or=function(){var e=sr(),t=e[0],n=e[1],r=xt("status")[0],i=ur(),a=i[0],o=i[1],l=!!(0,v.usePluginSetting)("subscription"),u=(0,v.usePluginSetting)("segmentEvaluation"),c=(r||"").includes("paused"),m=lr(),d=!c;return s.createElement("div",{className:"nab-edit-experiment__segmentation-section"},s.createElement("h2",null,(0,s.createInterpolateElement)((0,Fe.sprintf)(/* translators: dashicon */ /* translators: dashicon */
(0,Fe._x)("%s Segmentation","text","nelio-ab-testing"),"<icon></icon>"),{icon:s.createElement(ct.Dashicon,{className:"nab-segmentation-section__title-icon",icon:"groups"})}),"custom"===u&&s.createElement("div",{className:"nab-edit-experiment-segmentation-section__strategy"},s.createElement(ct.SelectControl,{value:a,options:[{value:"site",label:(0,Fe._x)("Evaluate on Site Landing","command","nelio-ab-testing")},{value:"tested-page",label:(0,Fe._x)("Evaluate on Tested Pages","text","nelio-ab-testing")}],onChange:o}))),l?s.createElement("div",{className:"nab-edit-experiment-segmentation-section__content"},s.createElement(er,null),t?s.createElement(Qn,{name:t.attributes.name,setName:function(e){return n(ar(ar({},t.attributes),{name:e}))},removeSegment:d?m:void 0}):s.createElement("p",{className:"nab-edit-experiment-segmentation-section__content--empty"},(0,Fe._x)("Add a new segment to narrow your tested audience and target only a subset of your visitors.","user","nelio-ab-testing"))):s.createElement("div",{className:"nab-edit-experiment-segmentation-section__content nab-edit-experiment-segmentation-section__content--free"},s.createElement("p",null,(0,Fe._x)("All your visitors participate in this test. Segmentation allows you to narrow your tested audience and target only a subset of your visitors.","user","nelio-ab-testing")),s.createElement("div",{className:"nab-edit-experiment-segmentation-section__content-action"},s.createElement(ct.ExternalLink,{className:"components-button is-secondary",href:(0,b.addFreeTracker)((0,Fe._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,Fe._x)("Subscribe to Unlock Segmentation","user","nelio-ab-testing")))))},sr=function(){var e=u((function(e){return e(lt).getActiveSegment()})),t=(0,l.useDispatch)(lt).updateSegment;return[e,function(n){(null==e?void 0:e.id)&&t(e.id,n)}]},lr=function(){var e=sr()[0],t=u((function(e){return e(lt).getSegments()})),n=(0,l.useDispatch)(lt),r=n.removeSegments,i=n.setActiveSegment;return e?function(){var n=function(e,t){var n=(0,d.findIndex)(e,{id:t});return e[n+1]||e[n-1]||!1}(t,e.id);n&&i(n.id),r(e.id)}:function(){return null}},ur=function(){return[u((function(e){return e(lt).getSegmentEvaluation()})),(0,l.useDispatch)(lt).setSegmentEvaluation]},cr=function(){var e=xt("status")[0];return s.createElement(ct.PanelRow,{className:"nab-experiment-management__status"},s.createElement("span",null,(0,Fe._x)("Status","text","nelio-ab-testing")),s.createElement("strong",{className:"nab-experiment-management__status-value"},function(e){switch(e){case"draft":return(0,Fe._x)("Draft","text (experiment status)","nelio-ab-testing");case"ready":return(0,Fe._x)("Ready","text (experiment status)","nelio-ab-testing");case"scheduled":return(0,Fe._x)("Scheduled","text (experiment status)","nelio-ab-testing");case"paused":return(0,Fe._x)("Paused","text (experiment status)","nelio-ab-testing");case"paused_draft":return(0,Fe._x)("Paused Draft","text (experiment status)","nelio-ab-testing");case"running":case"finished":case"trash":return"-"}}(e)))},mr=function(){var e=xt("startDate"),t=e[0],n=e[1],r=yt("professional"),i=dr();return s.createElement(ct.PanelRow,{className:"nab-experiment-start-schedule"},s.createElement("span",null,(0,Fe._x)("Start","text","nelio-ab-testing")),s.createElement("span",null,!!i&&s.createElement("span",{className:"nab-experiment-start-schedule__date"},(0,dt.formatI18nDatetime)(t)),!i&&!r&&s.createElement("span",{className:"nab-experiment-start-schedule__date"},(0,Fe._x)("Immediately","text","nelio-ab-testing")),!i&&!!r&&s.createElement(Bt.DateTimePicker,{className:"nab-experiment-start-schedule__date",date:t,onChange:function(e){return n(e||"")},noDateLabel:(0,Fe._x)("Immediately","text","nelio-ab-testing"),readonly:!0})))},dr=function(){return xt("status")[0].includes("paused")};const pr=window.wp.compose,vr=window.nab.i18n;var gr=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},fr=function(){var e=(0,pr.useInstanceId)(fr),t=yt("professional"),n=xt("endMode")[0],r=xt("endValue")[0],i=br(),a=hr[n],o=Er(),u=o[0],c=o[1],m=(0,l.useDispatch)(lt).setExperimentData,d=function(e,t){return m({endMode:e,endValue:t})};return t?s.createElement(ct.PanelRow,{className:"nab-experiment-end-schedule"},s.createElement("span",null,(0,Fe._x)("End","text","nelio-ab-testing")),s.createElement(ct.Dropdown,{placement:"bottom-end",contentClassName:"nab-experiment-end-schedule__dropdown",renderToggle:function(t){var i=t.onToggle,a=t.isOpen;return s.createElement(s.Fragment,null,s.createElement("label",{className:"nab-experiment-end-schedule__value screen-reader-text",htmlFor:"nab-experiment-end-schedule__toggle-".concat(e)},(0,Fe._x)("Click to change","command","nelio-ab-testing")),s.createElement(ct.Button,{variant:"link",id:"nab-experiment-end-schedule__toggle-".concat(e),type:"button",className:"nab-experiment-end-schedule__toggle",onClick:i,"aria-expanded":a,"aria-live":"polite"},function(e,t){switch(e){case"duration":return(0,Fe.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,Fe._n)("After %d day","After %d days",t,"nelio-ab-testing"),t);case"page-views":return(0,Fe.sprintf)(/* translators: a number */ /* translators: a number */
(0,Fe._n)("After %s page view","After %s page views",t,"nelio-ab-testing"),(0,vr.numberFormat)(t));case"confidence":return(0,Fe.sprintf)(/* translators: a percentage number, such as “95” */ /* translators: a percentage number, such as “95” */
(0,Fe._x)("At %1$s%% confidence","text","nelio-ab-testing"),(0,vr.numberFormat)(t));case"manual":return(0,Fe._x)("Manual","text","nelio-ab-testing")}}(n,r)))},renderContent:function(){return s.createElement(s.Fragment,null,s.createElement(ct.SelectControl,{label:(0,Fe._x)("End Mode","text","nelio-ab-testing"),value:n,onChange:function(e){c(!1),d(e,function(e){switch(e){case"duration":return 15;case"page-views":return 5e3;case"confidence":return 97;case"manual":return 0}}(e))},options:xr.filter((function(e){return"confidence"!==e.value||"nab/heatmap"!==i}))}),!!a&&s.createElement("div",{style:{marginTop:"1em"}},s.createElement(ct.SelectControl,{label:(0,Fe._x)("Value","text","nelio-ab-testing"),onChange:function(e){c("custom"===e),d(n,Number.parseInt(e)||0)},value:u?"custom":"".concat(r),options:a})),!!a&&u&&s.createElement("div",{style:{marginTop:"0.5em"}},s.createElement(ct.TextControl,{type:"number",placeholder:yr(n),value:r||"",onChange:function(e){return d(n,Number.parseInt(e)||0)}})))}})):s.createElement(ct.PanelRow,{className:"nab-experiment-end-schedule"},s.createElement("span",null,(0,Fe._x)("End","text","nelio-ab-testing")),s.createElement("span",null,(0,Fe._x)("Manual","text","nelio-ab-testing")))},br=function(){return u((function(e){return e(lt).getExperimentType()}))},Er=function(){var e=xt("endMode")[0],t=xt("endValue")[0],n=hr[e],r=!!(0,d.find)(n,{value:"custom"})&&!(0,d.find)(n,{value:"".concat(t)}),i=(0,s.useState)(r);return[i[0],i[1]]},xr=[{value:"manual",label:(0,Fe._x)("Manual","text","nelio-ab-testing")},{value:"duration",label:(0,Fe._x)("Duration","text","nelio-ab-testing")},{value:"page-views",label:(0,Fe._x)("Page Views","text","nelio-ab-testing")},{value:"confidence",label:(0,Fe._x)("Confidence","text","nelio-ab-testing")}],hr={manual:[],confidence:[95,96,97,98,99].map((function(e){return{value:"".concat(e),label:(0,Fe.sprintf)(/* translators: a percentage number, such as “95” */ /* translators: a percentage number, such as “95” */
(0,Fe._x)("%1$s%%","text","nelio-ab-testing"),(0,vr.numberFormat)(e))}})),duration:gr(gr([],[5,7,15,30,60,90].map((function(e){return{value:"".concat(e),label:(0,Fe.sprintf)(/* translators: number of days */ /* translators: number of days */
(0,Fe._n)("%d day","%d days",e,"nelio-ab-testing"),e)}})),!0),[{value:"custom",label:(0,Fe._x)("Custom","text","nelio-ab-testing"),placeholder:(0,Fe._x)("Days","text","nelio-ab-testing")}],!1),"page-views":gr(gr([],[2500,5e3,1e4,2e4,5e4,1e5].map((function(e){return{value:"".concat(e),label:(0,vr.numberFormat)(e)}})),!0),[{value:"custom",label:(0,Fe._x)("Custom","text","nelio-ab-testing"),placeholder:(0,Fe._x)("Days","text","nelio-ab-testing")}],!1)},yr=function(e){var t,n;return null!==(n=null===(t=(0,d.find)(hr[e],{value:"custom"}))||void 0===t?void 0:t.placeholder)&&void 0!==n?n:""},_r=function(){var e=xt("autoAlternativeApplication"),t=e[0],n=e[1],r=wr();return(0,s.useEffect)((function(){"yes"!==r&&n(!1)}),[r]),"no"===r?null:s.createElement("div",{className:"nab-experiment-auto-apply-winner"},s.createElement(ct.CheckboxControl,{className:Sn()({"nab-experiment-auto-apply-winner__checkbox":!0,"nab-experiment-auto-apply-winner__checkbox--disabled":"not-now"===r}),label:(0,Fe._x)("Apply winner automatically","command","nelio-ab-testing"),checked:t,onChange:n,disabled:"not-now"===r}))},wr=function(){var e=ht(),t=u((function(e){return e(lt).getAlternative("control")}));return t&&(null==e?void 0:e.supports.alternativeApplication)?"boolean"==typeof e.supports.alternativeApplication?e.supports.alternativeApplication?"yes":"no":e.supports.alternativeApplication(t.attributes)?"yes":"not-now":"no"},Sr=function(){var e=Ar(),t=(0,l.useDispatch)(lt).moveToTrash;return s.createElement(ct.PanelBody,{className:"nab-experiment-management",title:(0,Fe._x)("Status & Management","text (experiment)","nelio-ab-testing")},s.createElement(cr,null),s.createElement(mr,null),s.createElement(fr,null),s.createElement(_r,null),e&&s.createElement(ct.PanelRow,{className:"nab-experiment-management__trash"},s.createElement(ct.Button,{variant:"tertiary",isDestructive:!0,onClick:function(){t()}},(0,Fe._x)("Move to Trash","command (experiment)","nelio-ab-testing"))))},Ar=function(){return u((function(e){return e(v.store).hasCapability("delete_nab_experiments")}))},Nr=function(){var e=xt("description"),t=e[0],n=e[1];return s.createElement(ct.PanelBody,{className:"nab-experiment-description",title:(0,Fe._x)("Description","text","nelio-ab-testing")},s.createElement(ct.TextareaControl,{label:(0,Fe._x)("Describe your test (optional)","user","nelio-ab-testing"),className:"nab-experiment-description__textarea",value:t,onChange:n}))},Ir=function(){return Ir=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ir.apply(this,arguments)},Tr=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Rr=function(e){var t=e.rules,n=e.scopeSupport,r=(0,s.useState)((0,b.createScopeRule)({type:"partial",value:""})),i=r[0],a=r[1],o=(0,l.useDispatch)(lt).setScopeRules;return s.createElement(s.Fragment,null,s.createElement(Or,{rules:t,scopeSupport:n}),s.createElement("ul",{className:"nab-experiment-scope__rule-list"},Tr(Tr([],t,!0),[i],!1).map((function(e){var n=e.id,r=e.attributes;return s.createElement(Cr,{key:n,attributes:r,setAttributes:function(e){return function(e,n){var r=i.id===e;r&&a((0,b.createScopeRule)({type:"partial",value:""}));var s=Ir(Ir({},i),{attributes:n});o(r?Tr(Tr([],t,!0),[s],!1):t.map((function(t){return t.id===e?Ir(Ir({},t),{attributes:n}):t})))}(n,Ir(Ir({},r),e))}})}))))},Or=function(e){var t=e.rules,n=e.scopeSupport;return t.length?s.createElement("p",null,"urls-with-tested-post"===n?(0,Fe._x)("Variants will be visible on the tested element’s page, as well as pages matching one of the following criteria.","text","nelio-ab-testing"):(0,Fe._x)("Variants will be visible only on pages matching one of the following criteria.","text","nelio-ab-testing")," ",(0,Fe._x)("To remove one criterion, leave it empty and save the test.","user","nelio-ab-testing")):s.createElement("p",null,"urls-with-tested-post"===n?(0,Fe._x)("Variants will be visible on all the pages of your website, including that of the tested element.","user","nelio-ab-testing"):(0,Fe._x)("Variants will be visible on all the pages of your website.","user","nelio-ab-testing")," ",(0,Fe._x)("If you wish to limit its scope to certain pages only, use the following form to define the URLs in which the test should run.","user","nelio-ab-testing"))},Cr=function(e){var t=e.attributes,n=e.setAttributes,r=function(e,t){var n=(0,v.usePluginSetting)("homeUrl");switch(e){case"partial":case"partial-not-included":return t&&(0,b.isUrlFragmentInvalid)(t)||"";case"exact":case"different":return t&&(0,b.getLocalUrlError)(t,n)||""}}(t.type,t.value);return s.createElement("li",{className:Sn()({"nab-experiment-scope__rule-list-item":!0}),"data-operator":(0,Fe._x)("or","text","nelio-ab-testing")},s.createElement("div",{className:"nab-experiment-scope__rule-mode"},s.createElement(ct.SelectControl,{value:t.type,options:kr,onChange:function(e){return n({type:e})}})),s.createElement("div",{className:"nab-experiment-scope__rule-value"},s.createElement(ct.TextControl,{placeholder:(0,Fe._x)("Value","text","nelio-ab-testing"),value:t.value,onChange:function(e){return n({value:e})}}),s.createElement(Bt.ErrorText,{value:r})))},Dr={exact:(0,Fe._x)("URL is","text","nelio-ab-testing"),different:(0,Fe._x)("URL is not","text","nelio-ab-testing"),partial:(0,Fe._x)("URL contains","text","nelio-ab-testing"),"partial-not-included":(0,Fe._x)("URL does not contain","text","nelio-ab-testing")},kr=(0,d.keys)(Dr).map((function(e){return e})).map((function(e){return{label:Dr[e],value:e}})),Pr=function(e){var t=e.rules,n=Gr();return s.createElement(ct.CheckboxControl,{label:(0,Fe._x)("Global Consistency","command","nelio-ab-testing"),checked:!t.length,onChange:function(){return n(!t.length)},help:t.length?(0,Fe._x)("Variants will be visible only on the tested element’s page.","text","nelio-ab-testing"):(0,Fe._x)("Variants will be visible on the tested element’s page. All other pages will also show the appropriate variant of this test whenever the tested element appears on them.","text","nelio-ab-testing")})},Gr=function(){var e=(0,l.useDispatch)(lt).setScopeRules;return function(t){return e(t?[(0,b.createScopeRule)({type:"tested-post"})]:[])}},Br=function(e){var t=e.rules,n=Mr();return s.createElement(ct.CheckboxControl,{label:(0,Fe._x)("Product’s page only","command","nelio-ab-testing"),checked:t.length,onChange:function(){return n(!t.length)},help:t.length?(0,Fe._x)("Variants will be visible only on the tested product’s page.","text","nelio-ab-testing")+" "+(0,Fe._x)("Moreover, price testing is disabled.","user","nelio-ab-testing"):(0,Fe._x)("Variants will be visible everywhere on your store: the product’s page, shopping carts, the checkout page, on a “related products” section, etc.","text","nelio-ab-testing")})},Mr=function(){var e=(0,l.useDispatch)(lt).setScopeRules;return function(t){return e(t?[(0,b.createScopeRule)({type:"tested-post"})]:[])}},Lr=function(){return Lr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Lr.apply(this,arguments)},Vr=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Ur=function(e){var t,n,r=e.rules,i=(0,l.useDispatch)(lt).setScopeRules,a=null!==(t=r[0])&&void 0!==t?t:Wr,o=null!==(n=a.attributes.value.args)&&void 0!==n?n:[];return s.createElement("div",{className:"tested-url-with-query-args-scope"},s.createElement("p",null,(0,Fe._x)("Test will be active on tested URLs if their query parameters match the following conditions:","text","nelio-ab-testing")),s.createElement(jr,{value:o,onChange:function(e){return i([Lr(Lr({},a),{attributes:Lr(Lr({},a.attributes),{value:Lr(Lr({},a.attributes.value),{args:e})})})])}}))},jr=function(e){var t=e.value,n=e.onChange,r=(0,d.countBy)(t,"name");return s.createElement("div",{className:"tested-url-with-query-args-scope"},s.createElement("div",{className:"tested-url-with-query-args-scope__block"},s.createElement("div",{className:"tested-url-with-query-args-scope__arguments"},Vr(Vr([],t,!0),[Hr],!1).map((function(e,i){var a;return s.createElement(qr,{key:i,value:e,hasDuplicateName:!!e.name&&(null!==(a=r[e.name])&&void 0!==a?a:0)>=2,onChange:function(r){return n(Vr(Vr(Vr([],(0,d.take)(t,i),!0),[Lr(Lr({},e),r)],!1),(0,d.drop)(t,i+1),!0))}})})))))},qr=function(e){var t=e.hasDuplicateName,n=e.value,r=e.onChange;return s.createElement("div",{className:"tested-url-with-query-args-scope__argument","data-operator":(0,Fe._x)("and","text","nelio-ab-testing")},s.createElement("div",{className:"tested-url-with-query-args-scope__argument-setup"},s.createElement(ct.TextControl,{placeholder:(0,Fe._x)("Name","text","nelio-ab-testing"),value:n.name,onChange:function(e){return r({name:e})}}),s.createElement(ct.SelectControl,{options:Xr,value:n.condition,onChange:function(e){return r({condition:e})}})),s.createElement("div",{className:"tested-url-with-query-args-scope__argument-value"},s.createElement(Fr,{type:n.condition,value:n.value,onChange:function(e){return r({value:e})}})),t&&s.createElement("div",{className:"tested-url-with-query-args-scope__argument-error"},(0,Fe.sprintf)(/* translators: query parameter’s name */ /* translators: query parameter’s name */
(0,Fe._x)("Query parameter “%s” should only appear once in the test scope","text","nelio-ab-testing"),n.name)))},Fr=function(e){var t=e.type,n=e.value,r=e.onChange;switch(t){case"exists":case"does-not-exist":return null;case"is-equal-to":case"is-not-equal-to":case"contains":case"does-not-contain":return s.createElement(ct.TextControl,{placeholder:(0,Fe._x)("Value","text","nelio-ab-testing"),value:n,onChange:r});case"is-any-of":case"is-none-of":return s.createElement(ct.TextareaControl,{placeholder:(0,Fe._x)("Value (one per line)","text","nelio-ab-testing"),value:n,onChange:r})}},Hr={name:"",condition:"exists",value:""},Wr=(0,b.createScopeRule)({type:"tested-url-with-query-args",value:{urls:[],args:[]}}),Yr={exists:(0,Fe._x)("Exists","text","nelio-ab-testing"),"does-not-exist":(0,Fe._x)("Does not exist","text","nelio-ab-testing"),"is-equal-to":(0,Fe._x)("Is equal to","text","nelio-ab-testing"),"is-not-equal-to":(0,Fe._x)("Is not equal to","text","nelio-ab-testing"),contains:(0,Fe._x)("Contains","text","nelio-ab-testing"),"does-not-contain":(0,Fe._x)("Does not contain","text","nelio-ab-testing"),"is-any-of":(0,Fe._x)("Is any of","text","nelio-ab-testing"),"is-none-of":(0,Fe._x)("Is none of","text","nelio-ab-testing")},Xr=(0,d.toPairs)(Yr).map((function(e){var t=e[0];return{label:e[1],value:t}})),zr=function(){return zr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zr.apply(this,arguments)},Jr=function(e){var t=e.rules,n=(0,l.useDispatch)(lt).setScopeRules,r=t[0];return ei(r)?s.createElement(Qr,{rule:r}):s.createElement("div",null,s.createElement(Rr,{rules:t.filter(Zr),scopeSupport:"urls"}),s.createElement("br",null),s.createElement("p",null,(0,Fe._x)("Alternatively, you can specify where variants should be visible using PHP.","text","nelio-ab-testing")),s.createElement(ct.Button,{variant:"secondary",onClick:function(){return n([(0,b.createScopeRule)({type:"php-snippet",value:{priority:"low",snippet:"return true;",previewUrl:""}})])}},(0,Fe._x)("Define Scope in PHP","command","nelio-ab-testing")))},Qr=function(e){var t=e.rule,n=(0,l.useDispatch)(lt).setScopeRules,r=function(e){return n([zr(zr({},t),{attributes:zr(zr({},t.attributes),{value:zr(zr({},t.attributes.value),e)})})])},i=t.attributes.value,a=i.priority,o=i.snippet,u=i.errorMessage,c=i.warningMessage,m=i.previewUrl,d=(0,v.usePluginSetting)("homeUrl"),p=(0,b.getLocalUrlError)(m,d);return s.createElement("div",{className:"nab-edit-experiment-php-scope"},s.createElement(ct.SelectControl,{value:a,options:$r,onChange:function(e){return r({priority:e})}}),s.createElement("div",{className:"nab-edit-experiment-php-scope__snippet"},s.createElement(Bt.CodeEditor,{language:"php",withBorder:!0,before:"function is_test_active(): bool {",value:o,after:"}",onChange:function(e){return r({snippet:e,errorMessage:void 0,warningMessage:void 0,validateSnippet:!0})}})),!!u&&s.createElement("p",{className:"nab-edit-experiment-php-scope__snippet-error"},(0,Fe.sprintf)(/* translators: error message */
"There’s a problem with your code: %s",u)),!!c&&s.createElement("p",{className:"nab-edit-experiment-php-scope__snippet-error"},(0,Fe.sprintf)(/* translators: error message */
"There might be a problem with your code: %s",c)),s.createElement(ct.TextControl,{label:(0,Fe._x)("Preview URL","text","nelio-ab-testing"),value:m,onChange:function(e){return r({previewUrl:e})}}),p&&s.createElement("p",{className:"nab-edit-experiment-php-scope__preview-error"},p))},$r=[{value:"high",label:(0,Fe.sprintf)(/* translators: hook name */ /* translators: hook name */
(0,Fe._x)("Run on “%s”","command","nelio-ab-testing"),"plugins_loaded")},{value:"mid",label:(0,Fe.sprintf)(/* translators: hook name */ /* translators: hook name */
(0,Fe._x)("Run on “%s”","command","nelio-ab-testing"),"parse_query")},{value:"low",label:(0,Fe.sprintf)(/* translators: hook name */ /* translators: hook name */
(0,Fe._x)("Run on “%s”","command","nelio-ab-testing"),"wp")}],Kr={exact:!0,partial:!0,"partial-not-included":!0,different:!0},Zr=function(e){var t;return Kr[null!==(t=null==e?void 0:e.attributes.type)&&void 0!==t?t:""]||!1},ei=function(e){return"php-snippet"===(null==e?void 0:e.attributes.type)},ti=function(){var e=ni(),t=ri(),n=ii(),r=(0,l.useDispatch)(lt).setScopeRules;if((0,s.useEffect)((function(){"tested-post-with-consistency"===t&&n&&r([(0,b.createScopeRule)({type:"tested-post"})])}),[t,n]),!t)return null;if(n)return null;switch(t){case"tested-post-with-consistency":return s.createElement(ct.PanelBody,{className:"nab-experiment-scope",title:(0,Fe._x)("Test Scope","text","nelio-ab-testing")},s.createElement(Pr,{rules:e}));case"tested-product-with-consistency":return s.createElement(ct.PanelBody,{className:"nab-experiment-scope",title:(0,Fe._x)("Test Scope","text","nelio-ab-testing")},s.createElement(Br,{rules:e}));case"tested-url-with-query-args":return s.createElement(ct.PanelBody,{className:"nab-experiment-scope",title:(0,Fe._x)("Test Scope","text","nelio-ab-testing")},s.createElement(Ur,{rules:e.filter(ai)}));case"urls":case"urls-with-tested-post":return s.createElement(ct.PanelBody,{className:"nab-experiment-scope",title:(0,Fe._x)("Test Scope","text","nelio-ab-testing")},s.createElement(Rr,{rules:e.filter(si),scopeSupport:t}));case"urls-or-php":return s.createElement(ct.PanelBody,{className:"nab-experiment-scope",title:(0,Fe._x)("Test Scope","text","nelio-ab-testing")},s.createElement(Jr,{rules:e.filter((function(e){return si(e)||li(e)}))}))}},ni=function(){return u((function(e){return e(lt).getScope()}))},ri=function(){return u((function(e){return(0,e(We.store).getExperimentSupport)((0,e(lt).getExperimentType)(),"scope")}))},ii=function(){return u((function(e){var t=e(lt).getAlternative("control");return!!(null==t?void 0:t.attributes.testAgainstExistingContent)}))},ai=function(e){return"tested-url-with-query-args"===e.attributes.type},oi={exact:!0,partial:!0,"partial-not-included":!0,different:!0},si=function(e){return oi[e.attributes.type]||!1},li=function(e){return"php-snippet"===e.attributes.type},ui=function(){var e=ci();return s.createElement("div",{className:"nab-edit-experiment-sidebar",style:e},s.createElement("div",{className:"nab-edit-experiment-sidebar__element-wrapper"},s.createElement("h2",{className:"nab-edit-experiment-sidebar__section-title"},(0,s.createInterpolateElement)((0,Fe.sprintf)(/* translators: dashicon */ /* translators: dashicon */
(0,Fe._x)("%s Additional Settings","text","nelio-ab-testing"),"<icon></icon>"),{icon:s.createElement(ct.Dashicon,{className:"nab-edit-experiment-sidebar__section-title-icon",icon:"admin-settings"})})),s.createElement(Sr,null),s.createElement(Nr,null),s.createElement(ti,null)))},ci=function(){return u((function(e){var t=(0,e(v.store).getPageAttribute)("sidebarDimensions"),n=t.applyFix,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["applyFix"]);return n?r:void 0}))},mi=function(){return mi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mi.apply(this,arguments)},di=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},pi=function(e){var t=e.alternativeId,n=e.disabled,r=e.index,i=fi("control"),a=fi(t),o=xi(r),u=bi(),c=vi(),m=hi(r),d=Ei(),p=yi(),v=!r,g=_t(),f=gi(a),E=_i(a,i),x=wi(a,i),h=(0,l.useDispatch)(lt),y=h.saveExperimentAndEditAlternative,_=h.saveExperimentAndPreviewAlternative,w=h.removeAlternatives,S=h.replaceAlternatives,A=h.setAlternative;if(!a||!i)return null;var N=function(e){return A(a.id,mi(mi({},a),{attributes:(0,b.omitUndefineds)(mi(mi({},a.attributes),e))}))};return s.createElement("div",{className:Sn()(["nab-alternative-list__alternative",{"nab-alternative-list__alternative--original":v}])},s.createElement("p",{className:Sn()(["nab-alternative-list__alternative-letter",{"nab-alternative-list__alternative-letter--disabled":0<r&&n}])},(0,b.getLetter)(r)),s.createElement("div",{className:"nab-alternative-list__alternative-edit"},s.createElement(o,{attributes:a.attributes,disabled:n,experimentType:c,setAttributes:N}),0!==r&&s.createElement("ul",{className:"nab-alternative-list__alternative-actions"},x.map((function(e){return!e.isVisible||e.isVisible(a.attributes,i.attributes)?s.createElement("li",{key:"custom-action-".concat(e.id)},s.createElement(ct.Button,{variant:"link",disabled:n||d||e.isEnabled&&!e.isEnabled(a.attributes,i.attributes),onClick:function(){return e.onClick(a.attributes,N,i.attributes)}},e.label)):null})),p&&s.createElement("li",null,s.createElement(ct.Button,{variant:"link",disabled:n||d,onClick:function(){y(t)}},(0,Fe._x)("Edit","command","nelio-ab-testing"))),s.createElement("li",null,s.createElement(ct.Button,{variant:"link",disabled:n||d||E,onClick:function(){_(t)}},(0,Fe._x)("Preview","command","nelio-ab-testing"))),p&&!a.base&&g&&s.createElement("li",null,s.createElement(ct.Button,{variant:"link",disabled:n||d,onClick:f},(0,Fe._x)("Duplicate","command","nelio-ab-testing"))),p&&s.createElement("li",null,s.createElement(ct.Button,{variant:"link",disabled:n||d,onClick:function(){return S(t,(0,b.createAlternative)())}},(0,Fe._x)("Reset","command","nelio-ab-testing"))),u&&s.createElement("li",null,s.createElement(ct.Button,{variant:"link",isDestructive:!0,disabled:n||d,onClick:function(){return w(a.id)}},(0,Fe._x)("Delete","command","nelio-ab-testing"))))),s.createElement("div",{className:"nab-alternative-list__alternative-help"},!!m&&s.createElement(Bt.HelpIcon,{text:m})))},vi=function(){return u((function(e){return e(lt).getExperimentType()}))},gi=function(e){var t=u((function(e){return e(lt).getAlternatives()})),n=(0,l.useDispatch)(lt).replaceAlternatives;return e?function(){n(t.map((function(e){return e.id})),di(di([],t,!0),[(0,b.duplicateAlternative)(e)],!1))}:function(){}},fi=function(e){var t,n=(0,s.useState)(!1),r=n[0],i=n[1],a=(t=vi(),u((function(e){var n;return null===(n=e(We.store).getExperimentType(t))||void 0===n?void 0:n.defaults}))),o=(0,l.useDispatch)(lt).setAlternative,c=u((function(t){return t(lt).getAlternative(e)}));return(0,s.useEffect)((function(){if(!r&&a&&c){var t="control"===e?a.original:a.alternative;o(c.id,mi(mi({},c),{attributes:mi(mi({},t),c.attributes)})),i(!0)}}),[r,!!a,!!c]),r?c:void 0},bi=function(){var e=xt("status")[0];return u((function(t){var n=t(lt).getAlternativeIds,r=(e||"").includes("paused");return n().length>2&&!r}))},Ei=function(){return u((function(e){return e(lt).isExperimentBeingSaved()}))},xi=function(e){return u((function(t){var n=(0,t(We.store).getExperimentView)((0,t(lt).getExperimentType)(),e?"alternative":"original");return null!=n?n:function(){return s.createElement(s.Fragment,null)}}))},hi=function(e){return u((function(t){var n=t(lt).getExperimentType,r=t(We.store).getHelpString;return 0===e?r(n(),"original"):1===e?r(n(),"alternative"):""}))},yi=function(){var e=vi(),t=u((function(e){return e(lt).getAlternative("control")}));return u((function(n){var r=(0,n(We.store).getExperimentSupport)(e,"alternativeEdition");return"external"===(null==r?void 0:r.type)&&("function"!=typeof r.enabled||!!t&&r.enabled(t.attributes))}))},_i=function(e,t){return u((function(n){var r,i,a=(0,n(We.store).getExperimentType)(n(lt).getExperimentType());return!!(a&&e&&t)&&!!(null===(i=(r=a.checks).isAlternativePreviewDisabled)||void 0===i?void 0:i.call(r,e.attributes,t.attributes,n))}))},wi=function(e,t){return u((function(n){var r,i=(0,n(We.store).getExperimentType)(n(lt).getExperimentType());return i&&e&&t&&null!==(r=i.supports.alternativeCustomActions)&&void 0!==r?r:[]}))},Si=function(){var e=(0,l.useDispatch)(lt).closeAlternativePreviewer,t=u((function(e){return e(lt).getAlternativePreviewerUrl()}));return t?s.createElement(ct.Modal,{className:"nab-alternative-previewer",title:(0,Fe._x)("Alternative Preview","text","nelio-ab-testing"),isDismissible:!0,onRequestClose:e,shouldCloseOnClickOutside:!1},s.createElement("iframe",{className:"nab-alternative-previewer__iframe",title:(0,Fe._x)("Alternative Preview Frame","text","nelio-ab-testing"),src:t})):null},Ai=function(){var e=Ni(),t=e[0],n=e.slice(1),r=Ii(),i=wt(),a=St(),o=Ti(),l=Ri(),u=_t();return s.createElement("div",{className:"nab-edit-experiment__alternative-section"},s.createElement("h2",null,(0,s.createInterpolateElement)((0,Fe.sprintf)(/* translators: dashicon */ /* translators: dashicon */
(0,Fe._x)("%s Control Version and Variants","text","nelio-ab-testing"),"<icon></icon>"),{icon:s.createElement(ct.Dashicon,{className:"nab-alternative-section__title-icon",icon:"randomize"})})),s.createElement("div",{className:"nab-alternative-list"},!!t&&s.createElement(pi,{key:"control",index:0,alternativeId:"control",disabled:o}),s.createElement(Bt.AnimatedList,{disableAnimations:l,exit:500},n.map((function(e,t){return s.createElement(pi,{key:e,index:t+1,alternativeId:e,disabled:o})})))),s.createElement("div",{className:"nab-edit-experiment-alternative-section__new-variant-container"},u&&s.createElement(ct.Button,{variant:"secondary",key:"new-variant",disabled:o,onClick:function(){return r()}},(0,Fe._x)("New Variant","command","nelio-ab-testing")),!i&&!a&&s.createElement(ct.ExternalLink,{className:"components-button is-secondary",href:(0,b.addFreeTracker)((0,Fe._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,Fe._x)("Subscribe to Add More Variants","user","nelio-ab-testing"))),s.createElement(Si,null))},Ni=function(){return u((function(e){return e(lt).getAlternativeIds()}))},Ii=function(){var e=(0,l.useDispatch)(lt).addAlternatives;return function(){return e((0,b.createAlternative)())}},Ti=function(){return u((function(e){return e(lt).isTestedElementInvalid()}))},Ri=function(){var e,t,n,r,i,a=(0,s.useState)([]),o=a[0],l=a[1],u=o.join(";"),c=Ni(),m=c.join(";");return(0,s.useEffect)((function(){u!==m&&l(c)}),[u,m]),u!==m&&(e=m,t=u.split(";"),n=e.split(";"),r=(0,d.difference)(t,n),i=(0,d.difference)(n,t),!!r.length&&!!i.length)},Oi=function(){var e=Ci(),t=(0,l.useDispatch)(He.store).removeNotice;return s.createElement("div",{className:"nab-edit-experiment-layout"},s.createElement(Nt,null),s.createElement(Mt,null),s.createElement("div",{className:"nab-edit-experiment-layout__body"},s.createElement("div",{className:"nab-edit-experiment-layout__content",role:"region","aria-label":(0,Fe._x)("Editor content","text","nelio-ab-testing"),tabIndex:-1},!(0,b.isEmpty)(e)&&s.createElement(ct.NoticeList,{className:"nab-edit-experiment-layout__notices",notices:e,onRemove:t}),s.createElement(Yt,null),s.createElement(Ai,null),s.createElement(On,null),s.createElement(or,null)),s.createElement(ui,null)))},Ci=function(){return u((function(e){return e(He.store).getNotices()}))},Di=[{label:(0,Fe._x)("What is the original page or post of a test?","text","nelio-ab-testing"),link:(0,Fe._x)("https://neliosoftware.com/testing/help/what-is-the-original-page-or-post-of-a-test/","text","nelio-ab-testing")},{label:(0,Fe._x)("Why don’t all my posts/pages appear in the selection list when I’m creating a new test?","text","nelio-ab-testing"),link:(0,Fe._x)("https://neliosoftware.com/testing/help/why-dont-all-my-posts-appear-in-the-selection-list/","text","nelio-ab-testing")},{label:(0,Fe._x)("What is a conversion and what counts as one?","text","nelio-ab-testing"),link:(0,Fe._x)("https://neliosoftware.com/testing/help/what-is-a-conversion/","text","nelio-ab-testing")},{label:(0,Fe._x)("How can I track conversions occurring in third-party websites?","text","nelio-ab-testing"),link:(0,Fe._x)("https://neliosoftware.com/testing/help/how-can-i-track-conversions-occurring-in-third-party-websites/","text","nelio-ab-testing")}];function ki(e){var t,n,r,i,a=(0,l.select)(We.store).getExperimentType(e),o=(0,l.select)(v.store).isSubscribedTo;return[{title:(0,Fe._x)("Test Editor","text","nelio-ab-testing"),intro:(0,Fe._x)("Welcome to the Test Editor. Here you’ll be able to select the element you want to test and create one or more variants to find out which one converts the most. As you can see, it’s quite similar to WordPress’ Block Editor: there’s a header, a sidebar, and a main area.","user","nelio-ab-testing")},{title:(0,Fe._x)("Name","text","nelio-ab-testing"),intro:(0,Fe._x)("You’ll notice that all test types have a similar user interface. When creating a new test, you’ll first have to name it. Just type in a descriptive name that helps you identify the test in the future.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-title")}},{title:(0,Fe._x)("Variants","text","nelio-ab-testing"),intro:(0,Fe._x)("Next, there’s a “Control Version and Variants” section. Use it to (a) identify the element you want to test and (b) create one or more split testing variants.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__alternative-section")}},{title:(0,Fe._x)("Variant A","text","nelio-ab-testing"),intro:null!==(n=null===(t=null==a?void 0:a.help)||void 0===t?void 0:t.original)&&void 0!==n?n:"",element:function(){return document.querySelector(".nab-alternative-list__alternative--original")},active:function(){var e;return!!(null===(e=null==a?void 0:a.help)||void 0===e?void 0:e.original)}},{title:(0,Fe._x)("Variant B","text","nelio-ab-testing"),intro:null!==(i=null===(r=null==a?void 0:a.help)||void 0===r?void 0:r.alternative)&&void 0!==i?i:"",element:function(){return document.querySelector(".nab-alternative-list__alternative:not(.nab-alternative-list__alternative--original)")},active:function(){var e;return!!(null===(e=null==a?void 0:a.help)||void 0===e?void 0:e.alternative)&&!!document.querySelector(".nab-alternative-list__alternative:not(.nab-alternative-list__alternative--original)")}},{title:(0,Fe._x)("Goals","text","nelio-ab-testing"),intro:(0,Fe._x)("Split tests help you to improve the conversion rate of your website. Here you can set up the goals a test pursues and the specific conversion actions that, when performed by a visitor, will trigger a conversion.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__goal-section")},active:function(){var e;return!(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.automaticGoalSetup)}},{title:(0,Fe._x)("Goals","text","nelio-ab-testing"),intro:(0,Fe._x)("Split tests help you to improve the conversion rate of your website. With this type of test, the conversion goal and conversion action that might trigger a conversion is already set up by Nelio A/B Testing.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__goal-section")},active:function(){var e;return!!(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.automaticGoalSetup)}},{title:(0,Fe._x)("Actions","text","nelio-ab-testing"),intro:(0,Fe._x)("Use these buttons to add the specific conversion actions that might trigger a conversion like, for example, “visiting a page” or “clicking an element on the page.”","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-conversion-action-type-list")},active:function(){return!!document.querySelector(".nab-conversion-action-type-list")}},{title:(0,Fe._x)("Segmentation","text","nelio-ab-testing"),intro:(0,Fe._x)("If you subscribe to Nelio A/B Testing, you’ll be able to segment your visitors into groups and specify who may or may not participate in a test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__segmentation-section")},active:function(){return!!document.querySelector(".nab-edit-experiment-segmentation-section__content--free")}},{title:(0,Fe._x)("Segmentation","text","nelio-ab-testing"),intro:(0,Fe._x)("You can segment your audience into different groups and look at the performance of your split test with respect to each group. You can also use segmentation to limit who may or may not participate in a test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__segmentation-section")},active:function(){return!document.querySelector(".nab-edit-experiment-segmentation-section__content--free")}},{title:(0,Fe._x)("Status","text","nelio-ab-testing"),intro:(0,Fe._x)("Here you can see the current status of your test: once it’s “Ready,” you’ll be able to start it. Also, if you subscribe to our Professional plan, you’ll be able to schedule when a test should be started, as well as to define if and when it should be automatically stopped.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-management")},active:function(){return!o("professional")}},{title:(0,Fe._x)("Status","text","nelio-ab-testing"),intro:(0,Fe._x)("Here you can see the current status of your test: once it’s “Ready,” you’ll be able to start it. You can also schedule when the test should be started, as well as define a stop condition to automatically stop the test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-management")},active:function(){return o("professional")}},{title:(0,Fe._x)("Scope","text","nelio-ab-testing"),intro:(0,Fe._x)("By default, this type of test will show up on all pages of your website. You can limit its scope by specifying the URLs in which the test should be visible.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e,t;return"urls"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)||"urls-with-tested-post"===(null===(t=null==a?void 0:a.supports)||void 0===t?void 0:t.scope)}},{title:(0,Fe._x)("Scope","text","nelio-ab-testing"),intro:(0,Fe._x)("By default, this type of test will show up on all pages of your website. You can limit its scope by specifying the URLs in which the test should be visible.","user","nelio-ab-testing")+" "+(0,Fe._x)("Alternatively, you can specify where variants should be visible using PHP.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e;return"urls-or-php"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)}},{title:(0,Fe._x)("Scope","text","nelio-ab-testing"),intro:(0,Fe._x)("This type of test applies to a specific element of your website, be it a page, a post, or what. If you enable “Global Consistency,” our plugin will also load the appropriate variant on any page in which the tested element (i.e. its title, featured image, and so on) shows up.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e;return"tested-post-with-consistency"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)}},{title:(0,Fe._x)("Scope","text","nelio-ab-testing"),intro:(0,Fe._x)("This type of test applies to a specific product on your store. If you enable the option to run it on “product’s page only,” our plugin will only load alternative content when the visitor sees the tested product’s page. If the product shows up anywhere else on your store, the control version will be shown and no page views will be tracked.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e;return"tested-product-with-consistency"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)}}]}var Pi=function(e){var t=e.experimentId,n=u((function(e){return e(v.store).getExperiment(t)}));return(0,s.useEffect)((function(){var e;n&&(e=(0,l.select)(lt).getExperimentType(),(0,Bt.appendContextualHelp)({screen:"experiment-list:".concat(e),questions:Di,walkthrough:ki(e)}))}),[!!n]),s.createElement(s.StrictMode,null,s.createElement(ut,{experiment:n},s.createElement(Oi,null)))};function Gi(e,t){var n,r,i=document.getElementById(e);i?((0,g.registerCoreExperiments)(),(0,p.registerCoreConversionActions)(),(0,f.registerCoreSegmentationRules)(),n=s.createElement(Pi,{experimentId:t}),(r=i)&&(s.createRoot?(0,s.createRoot)(r).render(n):(0,s.render)(n,r))):console.warn("Unable to find container node ".concat(e,"."))}function Bi(){var e=window.innerHeight,t=document.getElementById("wpadminbar"),n=t?t.getBoundingClientRect().height:0;(0,(0,l.dispatch)(v.store).setPageAttribute)("sidebarDimensions",{top:n,height:"".concat(e-n,"px"),applyFix:782<=window.innerWidth})}window.addEventListener("resize",(0,d.debounce)(Bi,100)),m(Bi)},6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,a(n)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,i,a)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],a=e[c][2];for(var s=!0,l=0;l<n.length;l++)(!1&a||o>=a)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={6008:0,117:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,o=n[0],s=n[1],l=n[2],u=0;if(o.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(l)var c=l(r)}for(t&&t(n);u<o.length;u++)a=o[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},n=self.webpackChunknab=self.webpackChunknab||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=r.O(void 0,[117],(()=>r(5802)));i=r.O(i);var a=nab="undefined"==typeof nab?{}:nab;for(var o in i)a[o]=i[o];i.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();