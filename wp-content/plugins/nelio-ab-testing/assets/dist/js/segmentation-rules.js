(()=>{var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{segmentationRules:()=>o});var n={};e.r(n),e.d(n,{getSegmentationRuleType:()=>u,getSegmentationRuleTypeCategories:()=>c,getSegmentationRuleTypeCategory:()=>l,getSegmentationRuleTypes:()=>s});var r={};e.r(r),e.d(r,{addSegmentationRuleTypeCategories:()=>y,addSegmentationRuleTypes:()=>g,removeSegmentationRuleTypeCategories:()=>p,removeSegmentationRuleTypes:()=>m});var o={};e.r(o),e.d(o,{createSegmentationRule:()=>w,registerSegmentationRuleType:()=>U,registerSegmentationRuleTypeCategory:()=>M,store:()=>T});const a=window.wp.data,i=window.lodash;function s(e){return(0,i.values)(e.segmentationRuleTypes)}var u=function(e,t){return e.segmentationRuleTypes[t]};function c(e){return(0,i.values)(e.categories)}function l(e,t){return e.categories[t]}function g(e){return{type:"ADD_SEGMENTATION_RULE_TYPES",segmentationRuleTypes:(0,i.castArray)(e)}}function m(e){return{type:"REMOVE_SEGMENTATION_RULE_TYPES",names:(0,i.castArray)(e)}}function y(e){return{type:"ADD_SEGMENTATION_RULE_TYPE_CATEGORIES",categories:(0,i.castArray)(e)}}function p(e){return{type:"REMOVE_SEGMENTATION_RULE_TYPE_CATEGORIES",names:(0,i.castArray)(e)}}var f={segmentationRuleTypes:{},categories:{}},d=function(){return d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},d.apply(this,arguments)},T=(0,a.createReduxStore)("nab/segmentation-rules",{reducer:function(e,t){var n;return void 0===e&&(e=f),null!==(n=function(e,t){switch(t.type){case"ADD_SEGMENTATION_RULE_TYPES":return d(d({},e),{segmentationRuleTypes:d(d({},e.segmentationRuleTypes),(0,i.keyBy)(t.segmentationRuleTypes,"name"))});case"REMOVE_SEGMENTATION_RULE_TYPES":return d(d({},e),{segmentationRuleTypes:(0,i.omit)(e.segmentationRuleTypes,t.names)});case"ADD_SEGMENTATION_RULE_TYPE_CATEGORIES":return d(d({},e),{categories:d(d({},e.categories),(0,i.keyBy)(t.categories,"name"))});case"REMOVE_SEGMENTATION_RULE_TYPE_CATEGORIES":return d(d({},e),{categories:(0,i.omit)(e.categories,t.names)})}}(e,t))&&void 0!==n?n:e},selectors:n,actions:r});!function(e){(0,a.register)(e)}(T);const S={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var E,v=new Uint8Array(16);function R(){if(!E&&!(E="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(v)}for(var h=[],b=0;b<256;++b)h.push((b+256).toString(16).slice(1));const _=function(e,t,n){if(S.randomUUID&&!t&&!e)return S.randomUUID();var r=(e=e||{}).random||(e.rng||R)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}(r)};var O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},O.apply(this,arguments)};function w(e,t){var n=(0,(0,a.select)(T).getSegmentationRuleType)(e);if(n)return{id:_(),type:e,attributes:O(O({},n.attributes),t||{})}}const A=window.nab.utils;var I=function(){return I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)};function U(e,t){if("string"==typeof e)if(/^[a-z][a-z0-9-]*\/[a-z][a-z0-9-]*$/.test(e))if((0,a.select)(T).getSegmentationRuleType(e))console.error("Segmentation rule “".concat(e,"” is already registered."));else if(N(t))if(P(t))if((0,A.isValidIcon)(t.icon))if(D(t))if(j(t))if(L(t))if(C(t)){if(G(t)){var n=I({name:e},t);return(0,a.dispatch)(T).addSegmentationRuleTypes(n),n}console.error("Segmentation rule “".concat(e,"” must specify whether it’s singleton or not."))}else console.error("Segmentation rule “".concat(e,"” must have a category."));else console.error("Segmentation rule “".concat(e,"” must have a title."));else console.error("The “edit” property must be a valid function.");else console.error("The “view” property must be a valid function.");else console.error("The icon passed is invalid. The icon should be an element or a function.");else console.error("Segmentation rule “".concat(e,"” must have an icon."));else console.error("Segmentation rule “".concat(e,"” should specify its default attributes."));else console.error("Segmentation rule names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-segmentation-rule");else console.error("Segmentation rule names must be strings.")}function M(e,t){var n=I({name:e},t);if("string"==typeof e)if(/^[a-z][a-z0-9-]*\/[a-z][a-z0-9-]*$/.test(e))if((0,a.select)(T).getSegmentationRuleTypeCategory(e))console.error("Segmentation rule category “".concat(e,"” is already registered."));else if(P(n))if((0,A.isValidIcon)(n.icon)){if(L(n))return(0,a.dispatch)(T).addSegmentationRuleTypeCategories(n),n;console.error("Segmentation rule category “".concat(e,"” must have a title."))}else console.error("The icon passed is invalid. The icon should be an element or a function.");else console.error("Segmentation rule category “".concat(e,"” must have an icon."));else console.error("Segmentation rule category names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-segmentation-rule-category");else console.error("Segmentation rule category names must be strings.")}var N=function(e){return!!e.attributes},P=function(e){return"icon"in e},D=function(e){return(0,i.isFunction)(e.view)},j=function(e){return(0,i.isFunction)(e.edit)},C=function(e){return!!e.category},G=function(e){return void 0!==e.singleton&&"boolean"==typeof e.singleton},L=function(e){return!!e.title}})();var n=nab="undefined"==typeof nab?{}:nab;for(var r in t)n[r]=t[r];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();