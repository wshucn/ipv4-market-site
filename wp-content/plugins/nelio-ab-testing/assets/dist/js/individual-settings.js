(()=>{var e,t={7110:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initField:()=>ne});var r={};n.r(r),n.d(r,{getAttributes:()=>d,getValue:()=>u});var a={};n.r(a),n.d(a,{setAttributes:()=>g,setValue:()=>m});const o=window.wp.element,i=window.wp.data;function l(e,t){return(0,i.useSelect)(e,t)}var s={values:{},attributes:{}},c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c.apply(this,arguments)},u=function(e,t){return e.values[t]},d=function(e,t){return e.attributes[t]};function m(e,t){return{type:"SET_FIELD_VALUE",field:e,value:t}}function g(e,t){return{type:"SET_FIELD_ATTRIBUTES",field:e,attributes:t}}var p=(0,i.createReduxStore)("nab/individual-settings",{reducer:function(e,t){var n;return void 0===e&&(e=s),null!==(n=function(e,t){var n,r;switch(t.type){case"SET_FIELD_VALUE":return c(c({},e),{values:c(c({},e.values),(n={},n[t.field]=t.value,n))});case"SET_FIELD_ATTRIBUTES":return c(c({},e),{attributes:c(c({},e.attributes),(r={},r[t.field]=c(c({},e.attributes[t.field]),t.attributes),r))})}}(e,t))&&void 0!==n?n:e},controls:i.controls,actions:a,selectors:r});!function(e){(0,i.register)(e)}(p);const f=window.wp.components,b=window.wp.i18n;var v=function(){return v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},v.apply(this,arguments)};function h(e,t){var n=l((function(t){return t(p).getAttributes(e)})),r=(0,i.useDispatch)(p).setAttributes;return[v(v({},t),n),function(t){return r(e,t)}]}var y={mode:"redirection"},_=["match_all_segments","preload_query_args"],E=["exclude_bots","percentage_of_tested_visitors"];function x(e){e=e.replaceAll("_","-");var t=document.getElementById(e);t&&"disabled"in t&&(t.disabled=!0);var n=null==t?void 0:t.parentElement;n&&(n.style.opacity="0.8")}function w(e){e=e.replaceAll("_","-");var t=document.getElementById(e);if(null==t?void 0:t.dataset.disabled)x(e);else{t&&"disabled"in t&&(t.disabled=!1);var n=null==t?void 0:t.parentElement;n&&(n.style.opacity="")}}const k=window.wp.apiFetch;var S=n.n(k);const C=window.wp.date,N=window.wp.url;var D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},D.apply(this,arguments)};const O=function(e){var t=e.url,n=e.path,r=(0,C.format)("YmjHi").substring(0,11)+"0";return S()(D(D(D({},e),t&&{url:I(e)?(0,N.addQueryArgs)(t,{nabts:r}):t}),n&&{path:(0,N.addQueryArgs)(n,{nabts:r})}))};var I=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const T=window.wp.notices,A=window.lodash,V=window.nab.components,P=window.nab.data,U={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var j,R=new Uint8Array(16);function F(){if(!j&&!(j="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return j(R)}for(var L=[],M=0;M<256;++M)L.push((M+256).toString(16).slice(1));const B=function(e,t,n){if(U.randomUUID&&!t&&!e)return U.randomUUID();var r=(e=e||{}).random||(e.rng||F)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return function(e,t=0){return(L[e[t+0]]+L[e[t+1]]+L[e[t+2]]+L[e[t+3]]+"-"+L[e[t+4]]+L[e[t+5]]+"-"+L[e[t+6]]+L[e[t+7]]+"-"+L[e[t+8]]+L[e[t+9]]+"-"+L[e[t+10]]+L[e[t+11]]+L[e[t+12]]+L[e[t+13]]+L[e[t+14]]+L[e[t+15]]).toLowerCase()}(r)};var J={mode:"disabled",isCheckingStatus:!1,value:"",domain:"",domainStatus:"disabled",dnsValidation:{}},$=function(e){var t=e.name,n=h(t,J),r=n[0],a=n[1],i=r.mode,l=r.value;return"disabled"===i?o.createElement("input",{type:"hidden",name:"nelio-ab-testing_settings[cloud_proxy_setting]",value:JSON.stringify(r)}):"rest"===i?o.createElement("div",{className:"nab-cloud-proxy-setting__detail"},o.createElement(f.TextControl,{className:"nab-cloud-proxy-setting__detail-value",label:(0,b._x)("WordPress REST API Endpoint","text","nelio-ab-testing"),placeholder:(0,b._x)("/namespace/route","text","nelio-ab-testing"),value:l,onChange:function(e){return function(e){return a({value:e})}((0,A.trim)(e))},help:/^\/[a-z0-9-]+\/[a-z0-9-]+$/.test(l)?void 0:(0,b._x)("Please write a valid endpoint (/namespace/route)","user","nelio-ab-testing")}),o.createElement("input",{type:"hidden",name:"nelio-ab-testing_settings[cloud_proxy_setting]",value:JSON.stringify(r)})):o.createElement(z,{name:t})},z=function(e){var t=h(e.name,J),n=t[0],r=t[1],a=(0,o.useState)(!1),l=a[0],s=a[1],c=(0,o.useState)(!1),u=c[0],d=c[1],m=function(e){return r({domainStatus:e})},g=function(e){return r({isCheckingStatus:e})},p=n.mode,v=n.isCheckingStatus,y=n.domain,_=n.domainStatus,E=n.dnsValidation,x=G(y,_,E),w=q(_,E,v&&!l),k=H(),S=K(),C=(0,i.useDispatch)(T.store).removeNotice;if("domain-forwarding"!==p)return null;var N=["cert-validation-pending","cert-validation-success","success"].includes(_);return o.createElement("div",{className:"nab-cloud-proxy-setting__detail"},o.createElement(f.BaseControl,{id:"nab-cloud-domain-forwarder",className:"nab-cloud-proxy-setting__detail-domain",label:o.createElement(o.Fragment,null,(0,b._x)("Custom Forwarding Domain","text","nelio-ab-testing"),"success"===_?o.createElement(f.Dashicon,{icon:"yes-alt"}):o.createElement(f.Dashicon,{icon:"warning"})),help:x},o.createElement(f.TextControl,{placeholder:(0,b._x)("forwarder.yourdomain.com","text","nelio-ab-testing"),name:"nelio-ab-testing_settings[cloud_domain_forwarder]",disabled:v||N,value:y,onChange:function(e){return r({mode:"domain-forwarding",domain:e})}}),"success"!==_&&o.createElement(f.Button,{className:"nab-cloud-proxy-setting__detail-checker",variant:"secondary",disabled:v||!W(y),isBusy:v&&!l,onClick:function(){g(!0),O({path:"/nab/v1/domain/check",method:"POST",data:{domain:y,domainStatus:_}}).then((function(e){var t;m(e.status),"cert-validation-pending"===e.status&&(t={recordName:e.recordName||"",recordValue:e.recordValue||""},r({dnsValidation:t})),g(!1),e.status!==_&&"success"===e.status&&Q()})).catch((function(e){k(e.message),g(!1)}))}},w),N&&o.createElement(o.Fragment,null,o.createElement(f.Button,{className:"nab-cloud-proxy-setting__detail-reset",isDestructive:!0,disabled:v,isBusy:v&&l,onClick:function(){return d(!0)}},(0,b._x)("Disable","text","nelio-ab-testing")),o.createElement(V.ConfirmationDialog,{title:(0,b._x)("Disable Domain Forwarding?","text","nelio-ab-testing"),text:(0,b._x)("This action will remove the domain forwarding configuration in our servers. You will need to start the process from the beginning to set up domain forwarding again. Do you want to continue?","user","nelio-ab-testing"),confirmLabel:(0,b._x)("Continue","command","nelio-ab-testing"),cancelLabel:(0,b._x)("Back","command","nelio-ab-testing"),isDestructive:!0,onCancel:function(){return d(!1)},onConfirm:function(){d(!1),g(!0),s(!0),O({path:"/nab/v1/domain/reset",method:"POST"}).then((function(){m("disabled")})).catch((function(e){k(e.message)})).finally((function(){g(!1),s(!1),Q()}))},isOpen:u}))),"cert-validation-pending"===_&&!!E.recordName&&!!E.recordValue&&o.createElement(Y,{domain:y,recordName:E.recordName,recordValue:E.recordValue}),o.createElement("input",{type:"hidden",name:"nelio-ab-testing_settings[cloud_proxy_setting]",value:JSON.stringify(n)}),o.createElement(f.NoticeList,{className:"nab-cloud-proxy-setting__detail-errors",notices:S,onRemove:C}))},Y=function(e){var t=e.domain,n=e.recordName,r=e.recordValue;return o.createElement("table",{className:"nab-cloud-proxy-setting__detail-dns-record"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,(0,b._x)("Domain Name","text","nelio-ab-testing")),o.createElement("th",null,(0,b._x)("Record Name","text","nelio-ab-testing")),o.createElement("th",null,(0,b._x)("Record Type","text","nelio-ab-testing")),o.createElement("th",null,(0,b._x)("Record Value","text","nelio-ab-testing")))),o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",null,t),o.createElement("td",null,n),o.createElement("td",null,"CNAME"),o.createElement("td",null,r))))},W=function(e){return/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}$/i.test(e)},Q=function(){var e;null===(e=document.getElementById("submit"))||void 0===e||e.click()},q=function(e,t,n){switch(e){case"disabled":case"missing-forward":case"cert-validation-success":return n?(0,b._x)("Checking…","command","nelio-ab-testing"):(0,b._x)("Check","command","nelio-ab-testing");case"cert-validation-pending":return t.recordName&&t.recordValue?n?(0,b._x)("Validating…","command","nelio-ab-testing"):(0,b._x)("Validate","command","nelio-ab-testing"):n?(0,b._x)("Refreshing…","command","nelio-ab-testing"):(0,b._x)("Refresh","command","nelio-ab-testing");case"success":return(0,b._x)("Disable","text","nelio-ab-testing")}},G=function(e,t,n){switch(t){case"disabled":return(0,b._x)("Domain forwarding disabled","text","nelio-ab-testing");case"missing-forward":return(0,o.createInterpolateElement)((0,b.sprintf)(/* translators: domain */ /* translators: domain */
(0,b._x)("<strong>Step 1 of 3:</strong> To configure domain forwarding for %1$s, please add a CNAME record in your DNS configuration for %1$s and set the destination or target to <code>api.nelioabtesting.com</code>. If you are not familiar with CNAME records, contact your domain host, who can help you. Once created, <strong>check again</strong>. Note that the propagation of DNS records may take some time.","user","nelio-ab-testing"),"<code>".concat(e,"</code>"),"<code>".concat(e,"</code>")),{code:o.createElement("code",null),strong:o.createElement("strong",null)});case"cert-validation-pending":return n.recordName&&n.recordValue?(0,o.createInterpolateElement)((0,b._x)("Your domain is CNAMED correctly to our servers.<break></break><strong>Step 2 of 3:</strong> To validate the ownership of your domain, create the following DNS record:","user","nelio-ab-testing"),{break:o.createElement("br",null),strong:o.createElement("strong",null)}):(0,o.createInterpolateElement)((0,b._x)("Your domain is CNAMED correctly to our servers.<break></break><strong>Step 2 of 3:</strong> Now we need to validate that you are the owner of your domain by creating an additional DNS record. Click on the <strong>Refresh</strong> button to get the details about the DNS record that you need to create.","user","nelio-ab-testing"),{break:o.createElement("br",null),strong:o.createElement("strong",null)});case"cert-validation-success":return(0,o.createInterpolateElement)((0,b._x)("Your domain is CNAMED correctly to our servers.<break></break><strong>Step 3 of 3:</strong> We are configuring the forwarding on our end. Wait a few minutes and check again.","user","nelio-ab-testing"),{break:o.createElement("br",null),strong:o.createElement("strong",null)});case"success":return(0,b._x)("Domain forwarding successfully configured","text","nelio-ab-testing")}},H=function(){var e=(0,i.useDispatch)(T.store),t=e.createErrorNotice,n=e.removeNotice,r=(0,b._x)("Unknown error while checking domain forwarding status.","text","nelio-ab-testing");return function(e){var a=B();t(e||r,{id:a,onDismiss:function(){return n(a)}})}},K=function(){return l((function(e){return e(T.store).getNotices()}))},X={ips:[]},Z=function(e){switch(e){case"loading":return(0,b._x)("Loading, please wait…","text","nelio-ab-testing");case"ready":return(0,b._x)("One IP per line","text","nelio-ab-testing");case"error":return(0,b._x)("Something went wrong!","text","nelio-ab-testing")}},ee={name:"",value:"",_placeholder:""},te={AlternativeLoadingSetting:function(e){var t=e.name,n=h(t,y),r=n[0],a=n[1];return(0,o.useEffect)((function(){_.forEach("cookie"===r.mode?x:w),E.forEach("cookie"===r.mode&&r.lockParticipationSettings?x:w)}),[r]),o.createElement("div",{id:"alternative-loading-setting"},o.createElement(f.CheckboxControl,{label:(0,o.createInterpolateElement)((0,b.sprintf)("%1$s <link>%2$s</link>",(0,b.sprintf)(/* translators: a cookie name */ /* translators: a cookie name */
(0,b._x)("Load variants using %s cookie","command","nelio-ab-testing"),"<code>nabAlternative</code>"),(0,b._x)("Read more…","user","nelio-ab-testing")),{code:o.createElement("code",null),link:o.createElement("a",{href:"https://neliosoftware.com/testing/help/is-nelio-ab-testing-compatible-with-cache-plugins/#toc-method-2-cookie-based-testing-with-dynamic-caching-beta-6"})}),checked:"cookie"===r.mode,onChange:function(e){return a({mode:e?"cookie":"redirection"})}}),"cookie"===r.mode&&o.createElement(f.CheckboxControl,{label:(0,b._x)("Run JavaScript redirection if cookie is missing","command","nelio-ab-testing"),checked:!!r.redirectIfCookieIsMissing,onChange:function(e){return a({redirectIfCookieIsMissing:e||void 0})}}),"cookie"===r.mode&&o.createElement(f.CheckboxControl,{label:(0,b._x)("Lock participation settings","command","nelio-ab-testing"),checked:!!r.lockParticipationSettings,onChange:function(e){return a({lockParticipationSettings:e||void 0})}}),o.createElement("input",{type:"hidden",name:t,value:JSON.stringify(r)}))},CloudProxySetting:function(e){var t,n=e.name,r=h(n,J),a=r[0],i=r[1],s=(t=l((function(e){return e(P.store).isSubscribedTo("enterprise")})),[{value:"disabled",label:(0,b._x)("Disabled","text (proxy)","nelio-ab-testing")},{value:"rest",label:(0,b._x)("REST API","command","nelio-ab-testing")},{disabled:!t,value:"domain-forwarding",label:t?(0,b._x)("Domain Forwarding","text (proxy)","nelio-ab-testing"):(0,b._x)("Domain Forwarding (enterprise only)","text (proxy)","nelio-ab-testing")}]),c=a.mode;return o.createElement(o.Fragment,null,o.createElement(f.SelectControl,{className:"nab-cloud-proxy-setting__selector",options:s,value:c,onChange:function(e){return i({mode:e})}}),o.createElement($,{name:n}))},ExcludedIPsSetting:function(e){var t=e.name,n=function(e){var t=(0,o.useState)("loading"),n=t[0],r=t[1],a=h(e,X),i=a[0],l=a[1];return(0,o.useEffect)((function(){O({path:"/nab/v1/site/excluded-ips"}).then((function(e){l({ips:e}),r("ready")})).catch((function(){return r("error")}))}),[]),{ips:i.ips,setIPs:function(e){return l({ips:e,shouldForceUpdate:!0})},shouldForceUpdate:i.shouldForceUpdate,status:n}}(t),r=n.shouldForceUpdate,a=n.status,i=n.ips,l=n.setIPs;return o.createElement("div",{className:"nab-excluded-ips-setting"},o.createElement(f.TextareaControl,{disabled:"ready"!==a,value:i.join("\n"),onChange:function(e){return l(e.split("\n"))},placeholder:Z(a)}),"ready"===a&&o.createElement("input",{type:"hidden",name:t,value:i.join("\n")}),r&&o.createElement("input",{type:"hidden",name:"".concat(t.replace("]",""),"_force_update]"),value:"true"}))},GdprCookieSetting:function(e){var t=e.name,n=h(t,ee),r=n[0],a=n[1],i=r.name,l=r.value,s=r._placeholder;return o.createElement("div",{className:"nab-gdpr-cookie-setting"},o.createElement(f.TextControl,{value:i,onChange:function(e){return a({name:e})},placeholder:s||(0,b._x)("Cookie Name","text","nelio-ab-testing")}),!!i&&o.createElement(f.TextControl,{value:l,onChange:function(e){return a({value:e})},placeholder:(0,b._x)("Optional Cookie Value","text","nelio-ab-testing")}),o.createElement("input",{type:"hidden",name:t,value:JSON.stringify({name:i,value:l})}))}};function ne(e,t){var n=t.component,r=te[n];if(r){var a=document.getElementById(e);if(a){var l,s,c=t.name,u=t.value,d=t.attributes,m=(0,i.dispatch)(p),g=m.setValue,f=m.setAttributes;g(c,u),f(c,d),l=o.createElement(r,{name:c}),(s=a)&&(o.createRoot?(0,o.createRoot)(s).render(l):(0,o.render)(l,s))}}}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,a,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],o=e[u][2];for(var l=!0,s=0;s<n.length;s++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(l=!1,o<i&&(i=o));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={516:0,1075:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,i=n[0],l=n[1],s=n[2],c=0;if(i.some((t=>0!==e[t]))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(s)var u=s(r)}for(t&&t(n);c<i.length;c++)o=i[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=self.webpackChunknab=self.webpackChunknab||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[1075],(()=>r(7110)));a=r.O(a);var o=nab="undefined"==typeof nab?{}:nab;for(var i in a)o[i]=a[i];a.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();